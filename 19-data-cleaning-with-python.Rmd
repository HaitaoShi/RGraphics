# 正则表达式与 Python {#regex-python}

```{r,include=FALSE,eval=is_windows}
# reticulate::conda_create(envname = 'r-tensorflow')
reticulate::use_condaenv(condaenv = 'r-tensorflow', required = TRUE)
```

::: sidebar
在 `knitr::opts_chunk` 中设置 `python.reticulate = TRUE` 意味着所有的 Python 代码块共享一个 Python Session，而 `python.reticulate = FALSE` 意味着使用 knitr 提供的 Python 引擎，所有的 Python 代码块独立运行。

`python.reticulate = TRUE` 会使用 reticulate 提供的 Python 引擎，它支持 matplotlib 绘图，但是不支持图 caption，knitr 的 python 引擎是支持 caption 的

R 和 Python 之间的交互，Python 负责数据处理和建模， R 负责绘图，有些复杂的机器学习模型及其相关数据操作需要在 Python 中完成，数据集清理至数据框的形式后导入到 R 中，画各种静态或者动态图，这时候需要加载 reticulate 包，只是设置 `python.reticulate = TRUE` 还不够
:::

## 字符串操作 {#python-str}

字符串基本操作

```{python}
dir(str)
dir(str.split)
```


## re 模块 {#re} 

字符串基本操作

```{python}
import re
import sys
```

re 模块

```{python}
m = re.search('(?<=abc)def', 'abcdef')
m.group(0)
sys.path
```

## R 调用 Python {#r-call-python}

pandas 读取数据，整理后由 reticulate 包传递给 R 环境中的 data.frame 对象，加载 ggplot2 绘图

```{python}
# write.csv(iris, file = 'data/iris.csv', row.names = F)
import pandas as pd
iris2 = pd.read_csv('data/iris.csv')
```

如图 \@ref(fig:reti-plot) 所示

```{r reti-plot,fig.cap="散点图"}
library(reticulate)
library(ggplot2)
ggplot(py$iris2, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point()
```

