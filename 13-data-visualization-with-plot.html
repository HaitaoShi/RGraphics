<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 12 章 绘图素材库 | 数据可视化与R语言</title>
  <meta name="description" content="学习 R Graphics 部分的测试代码，函数各参数含义的查询手册，主要目的是帮助读者读懂参考手册，写作过程分步走：学习知识，记笔记，可写本书上，博客侧重在某个点的内容扩展上，书籍需要照顾覆盖面，各部分平衡一点，整理心得，再次修改笔记以符合书籍。所有的案例都基于真实数据集，基础 R 打包的数据集都是真实的，扩展案例就是在规模上进行扩展，选用基础 R 中的数据，原因是收集清洗真实数据是比较麻烦和费时间的事情。数据操作和数据清理部分以Base R为主，在sidebar中给出tidyverse的等价表示。数据可视化部分以ggplot2为主，在sidebar中给出Base R的等价表示" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="第 12 章 绘图素材库 | 数据可视化与R语言" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/xiangyun/RGraphics/" />
  
  <meta property="og:description" content="学习 R Graphics 部分的测试代码，函数各参数含义的查询手册，主要目的是帮助读者读懂参考手册，写作过程分步走：学习知识，记笔记，可写本书上，博客侧重在某个点的内容扩展上，书籍需要照顾覆盖面，各部分平衡一点，整理心得，再次修改笔记以符合书籍。所有的案例都基于真实数据集，基础 R 打包的数据集都是真实的，扩展案例就是在规模上进行扩展，选用基础 R 中的数据，原因是收集清洗真实数据是比较麻烦和费时间的事情。数据操作和数据清理部分以Base R为主，在sidebar中给出tidyverse的等价表示。数据可视化部分以ggplot2为主，在sidebar中给出Base R的等价表示" />
  <meta name="github-repo" content="XiangyunHuang/RGraphics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 12 章 绘图素材库 | 数据可视化与R语言" />
  
  <meta name="twitter:description" content="学习 R Graphics 部分的测试代码，函数各参数含义的查询手册，主要目的是帮助读者读懂参考手册，写作过程分步走：学习知识，记笔记，可写本书上，博客侧重在某个点的内容扩展上，书籍需要照顾覆盖面，各部分平衡一点，整理心得，再次修改笔记以符合书籍。所有的案例都基于真实数据集，基础 R 打包的数据集都是真实的，扩展案例就是在规模上进行扩展，选用基础 R 中的数据，原因是收集清洗真实数据是比较麻烦和费时间的事情。数据操作和数据清理部分以Base R为主，在sidebar中给出tidyverse的等价表示。数据可视化部分以ggplot2为主，在sidebar中给出Base R的等价表示" />
  

<meta name="author" content="黄湘云" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="12-data-cleaning-with-regexp.html">
<link rel="next" href="14-data-visualization-with-plot3d.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">数据可视化与R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>欢迎</a></li>
<li class="chapter" data-level="" data-path="01-preface.html"><a href="01-preface.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="01-preface.html"><a href="01-preface.html#what-talk-about"><i class="fa fa-check"></i>关于本书</a></li>
<li class="chapter" data-level="" data-path="01-preface.html"><a href="01-preface.html#structure-of-book"><i class="fa fa-check"></i>本书结构</a></li>
<li class="chapter" data-level="" data-path="01-preface.html"><a href="01-preface.html#about-author"><i class="fa fa-check"></i>关于作者</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="02-introduction.html"><a href="02-introduction.html"><i class="fa fa-check"></i><b>1</b> 介绍</a><ul>
<li class="chapter" data-level="1.1" data-path="02-introduction.html"><a href="02-introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R</a></li>
<li class="chapter" data-level="1.2" data-path="02-introduction.html"><a href="02-introduction.html#who-read-this-book"><i class="fa fa-check"></i><b>1.2</b> 目标读者</a></li>
<li class="chapter" data-level="1.3" data-path="02-introduction.html"><a href="02-introduction.html#Getting-Help-with-R"><i class="fa fa-check"></i><b>1.3</b> 获取帮助</a></li>
<li class="chapter" data-level="1.4" data-path="02-introduction.html"><a href="02-introduction.html#history-of-r"><i class="fa fa-check"></i><b>1.4</b> 发展历史</a></li>
<li class="chapter" data-level="1.5" data-path="02-introduction.html"><a href="02-introduction.html#conventions"><i class="fa fa-check"></i><b>1.5</b> 记号约定</a></li>
<li class="chapter" data-level="1.6" data-path="02-introduction.html"><a href="02-introduction.html#softwares-rsession-info"><i class="fa fa-check"></i><b>1.6</b> 软件信息</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="03-setup.html"><a href="03-setup.html"><i class="fa fa-check"></i><b>2</b> 安装与配置</a><ul>
<li class="chapter" data-level="2.1" data-path="03-setup.html"><a href="03-setup.html#repo-install"><i class="fa fa-check"></i><b>2.1</b> 仓库安装</a><ul>
<li class="chapter" data-level="2.1.1" data-path="03-setup.html"><a href="03-setup.html#ubuntu"><i class="fa fa-check"></i><b>2.1.1</b> Ubuntu</a></li>
<li class="chapter" data-level="2.1.2" data-path="03-setup.html"><a href="03-setup.html#centos"><i class="fa fa-check"></i><b>2.1.2</b> CentOS</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="03-setup.html"><a href="03-setup.html#source-install"><i class="fa fa-check"></i><b>2.2</b> 源码安装</a><ul>
<li class="chapter" data-level="2.2.1" data-path="03-setup.html"><a href="03-setup.html#ubuntu-1"><i class="fa fa-check"></i><b>2.2.1</b> Ubuntu</a></li>
<li class="chapter" data-level="2.2.2" data-path="03-setup.html"><a href="03-setup.html#centos-1"><i class="fa fa-check"></i><b>2.2.2</b> CentOS</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="03-setup.html"><a href="03-setup.html#ninja-install"><i class="fa fa-check"></i><b>2.3</b> 忍者安装</a></li>
<li class="chapter" data-level="2.4" data-path="03-setup.html"><a href="03-setup.html#settings"><i class="fa fa-check"></i><b>2.4</b> 配置</a><ul>
<li class="chapter" data-level="2.4.1" data-path="03-setup.html"><a href="03-setup.html#init-session"><i class="fa fa-check"></i><b>2.4.1</b> 初始会话 <code>.Rprofile</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="03-setup.html"><a href="03-setup.html#environ-vars"><i class="fa fa-check"></i><b>2.4.2</b> 环境变量 <code>.Renviron</code></a></li>
<li class="chapter" data-level="2.4.3" data-path="03-setup.html"><a href="03-setup.html#make-vars"><i class="fa fa-check"></i><b>2.4.3</b> 编译选项 <code>Makevars</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="03-setup.html"><a href="03-setup.html#command-line-arguments"><i class="fa fa-check"></i><b>2.5</b> 命令行参数</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="04-file-system.html"><a href="04-file-system.html"><i class="fa fa-check"></i><b>3</b> 文件管理员</a><ul>
<li class="chapter" data-level="3.1" data-path="04-file-system.html"><a href="04-file-system.html#list"><i class="fa fa-check"></i><b>3.1</b> 查看文件</a></li>
<li class="chapter" data-level="3.2" data-path="04-file-system.html"><a href="04-file-system.html#manipulation"><i class="fa fa-check"></i><b>3.2</b> 操作文件</a></li>
<li class="chapter" data-level="3.3" data-path="04-file-system.html"><a href="04-file-system.html#compression"><i class="fa fa-check"></i><b>3.3</b> 压缩文件</a></li>
<li class="chapter" data-level="3.4" data-path="04-file-system.html"><a href="04-file-system.html#paths"><i class="fa fa-check"></i><b>3.4</b> 路径操作</a></li>
<li class="chapter" data-level="3.5" data-path="04-file-system.html"><a href="04-file-system.html#find"><i class="fa fa-check"></i><b>3.5</b> 查找文件</a></li>
<li class="chapter" data-level="3.6" data-path="04-file-system.html"><a href="04-file-system.html#permissions"><i class="fa fa-check"></i><b>3.6</b> 文件权限</a></li>
<li class="chapter" data-level="3.7" data-path="04-file-system.html"><a href="04-file-system.html#locale"><i class="fa fa-check"></i><b>3.7</b> 区域设置</a></li>
<li class="chapter" data-level="3.8" data-path="04-file-system.html"><a href="04-file-system.html#process"><i class="fa fa-check"></i><b>3.8</b> 进程管理</a></li>
<li class="chapter" data-level="3.9" data-path="04-file-system.html"><a href="04-file-system.html#system-commands"><i class="fa fa-check"></i><b>3.9</b> 系统命令</a></li>
<li class="chapter" data-level="3.10" data-path="04-file-system.html"><a href="04-file-system.html#time"><i class="fa fa-check"></i><b>3.10</b> 时间管理</a></li>
<li class="chapter" data-level="3.11" data-path="04-file-system.html"><a href="04-file-system.html#package"><i class="fa fa-check"></i><b>3.11</b> R 包管理</a></li>
<li class="chapter" data-level="3.12" data-path="04-file-system.html"><a href="04-file-system.html#lookup-function"><i class="fa fa-check"></i><b>3.12</b> 查找函数</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="05-data-object.html"><a href="05-data-object.html"><i class="fa fa-check"></i><b>4</b> 对象在哪里</a><ul>
<li class="chapter" data-level="4.1" data-path="05-data-object.html"><a href="05-data-object.html#oop-vector"><i class="fa fa-check"></i><b>4.1</b> 向量</a></li>
<li class="chapter" data-level="4.2" data-path="05-data-object.html"><a href="05-data-object.html#oop-matrix"><i class="fa fa-check"></i><b>4.2</b> 矩阵</a></li>
<li class="chapter" data-level="4.3" data-path="05-data-object.html"><a href="05-data-object.html#oop-array"><i class="fa fa-check"></i><b>4.3</b> 数组</a></li>
<li class="chapter" data-level="4.4" data-path="05-data-object.html"><a href="05-data-object.html#oop-data.frame"><i class="fa fa-check"></i><b>4.4</b> 数据框</a></li>
<li class="chapter" data-level="4.5" data-path="05-data-object.html"><a href="05-data-object.html#oop-table"><i class="fa fa-check"></i><b>4.5</b> 表格</a></li>
<li class="chapter" data-level="4.6" data-path="05-data-object.html"><a href="05-data-object.html#oop-list"><i class="fa fa-check"></i><b>4.6</b> 列表</a></li>
<li class="chapter" data-level="4.7" data-path="05-data-object.html"><a href="05-data-object.html#oop-ts"><i class="fa fa-check"></i><b>4.7</b> 时间序列</a></li>
<li class="chapter" data-level="4.8" data-path="05-data-object.html"><a href="05-data-object.html#oop-sf"><i class="fa fa-check"></i><b>4.8</b> 空间数据</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="06-data-import-export.html"><a href="06-data-import-export.html"><i class="fa fa-check"></i><b>5</b> 数据搬运工</a><ul>
<li class="chapter" data-level="5.1" data-path="06-data-import-export.html"><a href="06-data-import-export.html#import-data-files"><i class="fa fa-check"></i><b>5.1</b> 导入数据文件</a><ul>
<li class="chapter" data-level="5.1.1" data-path="06-data-import-export.html"><a href="06-data-import-export.html#scan-file"><i class="fa fa-check"></i><b>5.1.1</b> <code>scan</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="06-data-import-export.html"><a href="06-data-import-export.html#read-write-table"><i class="fa fa-check"></i><b>5.1.2</b> <code>read.table</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="06-data-import-export.html"><a href="06-data-import-export.html#read-write-lines"><i class="fa fa-check"></i><b>5.1.3</b> <code>readLines</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="06-data-import-export.html"><a href="06-data-import-export.html#read-save-rds"><i class="fa fa-check"></i><b>5.1.4</b> <code>readRDS</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="06-data-import-export.html"><a href="06-data-import-export.html#load-save"><i class="fa fa-check"></i><b>5.2</b> 保存输出结果</a></li>
<li class="chapter" data-level="5.3" data-path="06-data-import-export.html"><a href="06-data-import-export.html#save-data-object"><i class="fa fa-check"></i><b>5.3</b> 保存数据对象</a></li>
<li class="chapter" data-level="5.4" data-path="06-data-import-export.html"><a href="06-data-import-export.html#other-data-source"><i class="fa fa-check"></i><b>5.4</b> 其它数据格式</a></li>
<li class="chapter" data-level="5.5" data-path="06-data-import-export.html"><a href="06-data-import-export.html#batch-import-data"><i class="fa fa-check"></i><b>5.5</b> 批量导入数据</a></li>
<li class="chapter" data-level="5.6" data-path="06-data-import-export.html"><a href="06-data-import-export.html#batch-export-data"><i class="fa fa-check"></i><b>5.6</b> 批量导出数据</a></li>
<li class="chapter" data-level="5.7" data-path="06-data-import-export.html"><a href="06-data-import-export.html#import-large-csv-files"><i class="fa fa-check"></i><b>5.7</b> 导入大数据集</a></li>
<li class="chapter" data-level="5.8" data-path="06-data-import-export.html"><a href="06-data-import-export.html#import-data-from-database"><i class="fa fa-check"></i><b>5.8</b> 从数据库导入</a><ul>
<li class="chapter" data-level="5.8.1" data-path="06-data-import-export.html"><a href="06-data-import-export.html#rsqlite"><i class="fa fa-check"></i><b>5.8.1</b> RSQLite</a></li>
<li class="chapter" data-level="5.8.2" data-path="06-data-import-export.html"><a href="06-data-import-export.html#postgresql"><i class="fa fa-check"></i><b>5.8.2</b> PostgreSQL</a></li>
<li class="chapter" data-level="5.8.3" data-path="06-data-import-export.html"><a href="06-data-import-export.html#clickhouse"><i class="fa fa-check"></i><b>5.8.3</b> ClickHouse</a></li>
<li class="chapter" data-level="5.8.4" data-path="06-data-import-export.html"><a href="06-data-import-export.html#mysql"><i class="fa fa-check"></i><b>5.8.4</b> MySQL</a></li>
<li class="chapter" data-level="5.8.5" data-path="06-data-import-export.html"><a href="06-data-import-export.html#spark"><i class="fa fa-check"></i><b>5.8.5</b> Spark</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="07-data-rectangling.html"><a href="07-data-rectangling.html"><i class="fa fa-check"></i><b>6</b> 数据异形者</a></li>
<li class="chapter" data-level="7" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html"><i class="fa fa-check"></i><b>7</b> 数据操作手</a><ul>
<li class="chapter" data-level="7.1" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#show"><i class="fa fa-check"></i><b>7.1</b> 查看数据</a></li>
<li class="chapter" data-level="7.2" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-reshape"><i class="fa fa-check"></i><b>7.2</b> 数据变形</a></li>
<li class="chapter" data-level="7.3" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-transform"><i class="fa fa-check"></i><b>7.3</b> 数据转换</a></li>
<li class="chapter" data-level="7.4" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-subset"><i class="fa fa-check"></i><b>7.4</b> 提取子集</a></li>
<li class="chapter" data-level="7.5" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-order"><i class="fa fa-check"></i><b>7.5</b> 按列排序</a></li>
<li class="chapter" data-level="7.6" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-split"><i class="fa fa-check"></i><b>7.6</b> 数据拆分</a></li>
<li class="chapter" data-level="7.7" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-merge"><i class="fa fa-check"></i><b>7.7</b> 数据合并</a></li>
<li class="chapter" data-level="7.8" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-duplicated"><i class="fa fa-check"></i><b>7.8</b> 数据去重</a></li>
<li class="chapter" data-level="7.9" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-aggregate"><i class="fa fa-check"></i><b>7.9</b> 数据聚合</a></li>
<li class="chapter" data-level="7.10" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-table"><i class="fa fa-check"></i><b>7.10</b> 表格统计</a></li>
<li class="chapter" data-level="7.11" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-index"><i class="fa fa-check"></i><b>7.11</b> 索引访问</a></li>
<li class="chapter" data-level="7.12" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-array"><i class="fa fa-check"></i><b>7.12</b> 多维数组</a></li>
<li class="chapter" data-level="7.13" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#base-others"><i class="fa fa-check"></i><b>7.13</b> 其它操作</a><ul>
<li class="chapter" data-level="7.13.1" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#list-or-unlist"><i class="fa fa-check"></i><b>7.13.1</b> 列表属性</a></li>
<li class="chapter" data-level="7.13.2" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#stack-or-unstack"><i class="fa fa-check"></i><b>7.13.2</b> 堆叠向量</a></li>
<li class="chapter" data-level="7.13.3" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#class-or-unclass"><i class="fa fa-check"></i><b>7.13.3</b> 属性转化</a></li>
<li class="chapter" data-level="7.13.4" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#attach-or-detach"><i class="fa fa-check"></i><b>7.13.4</b> 绑定环境</a></li>
<li class="chapter" data-level="7.13.5" data-path="08-data-manipulation.html"><a href="08-data-manipulation.html#with-or-within"><i class="fa fa-check"></i><b>7.13.5</b> 数据环境</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html"><i class="fa fa-check"></i><b>8</b> 向量化操作</a><ul>
<li class="chapter" data-level="8.1" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#common-operations"><i class="fa fa-check"></i><b>8.1</b> 常用操作</a><ul>
<li class="chapter" data-level="8.1.1" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#tibble-show"><i class="fa fa-check"></i><b>8.1.1</b> 查看</a></li>
<li class="chapter" data-level="8.1.2" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#dplyr-subset"><i class="fa fa-check"></i><b>8.1.2</b> 筛选</a></li>
<li class="chapter" data-level="8.1.3" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#dplyr-order"><i class="fa fa-check"></i><b>8.1.3</b> 排序</a></li>
<li class="chapter" data-level="8.1.4" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#dplyr-aggregate"><i class="fa fa-check"></i><b>8.1.4</b> 聚合</a></li>
<li class="chapter" data-level="8.1.5" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#dplyr-merge"><i class="fa fa-check"></i><b>8.1.5</b> 合并</a></li>
<li class="chapter" data-level="8.1.6" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#dplyr-reshape"><i class="fa fa-check"></i><b>8.1.6</b> 重塑</a></li>
<li class="chapter" data-level="8.1.7" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#dplyr-transform"><i class="fa fa-check"></i><b>8.1.7</b> 变换</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#common-dataframe-operations"><i class="fa fa-check"></i><b>8.2</b> 高频问题</a><ul>
<li class="chapter" data-level="8.2.1" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#create-empty-dataframe"><i class="fa fa-check"></i><b>8.2.1</b> 初始化数据框</a></li>
<li class="chapter" data-level="8.2.2" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#remove-missing-values"><i class="fa fa-check"></i><b>8.2.2</b> 移除缺失记录</a></li>
<li class="chapter" data-level="8.2.3" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#coerce-data-type"><i class="fa fa-check"></i><b>8.2.3</b> 数据类型转化</a></li>
<li class="chapter" data-level="8.2.4" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#cross-group-by"><i class="fa fa-check"></i><b>8.2.4</b> 跨列分组求和</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#parallel-computing"><i class="fa fa-check"></i><b>8.3</b> 并行计算</a><ul>
<li class="chapter" data-level="8.3.1" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#apply"><i class="fa fa-check"></i><b>8.3.1</b> apply</a></li>
<li class="chapter" data-level="8.3.2" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#map-reduce"><i class="fa fa-check"></i><b>8.3.2</b> MapReduce</a></li>
<li class="chapter" data-level="8.3.3" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#parallel"><i class="fa fa-check"></i><b>8.3.3</b> parallel</a></li>
<li class="chapter" data-level="8.3.4" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#rmpi"><i class="fa fa-check"></i><b>8.3.4</b> Rmpi</a></li>
<li class="chapter" data-level="8.3.5" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#gpur"><i class="fa fa-check"></i><b>8.3.5</b> gpuR</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="09-vector-manipulation.html"><a href="09-vector-manipulation.html#pipe-manipulation"><i class="fa fa-check"></i><b>8.4</b> 管道操作</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html"><i class="fa fa-check"></i><b>9</b> 字符串操作</a><ul>
<li class="chapter" data-level="9.1" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-count"><i class="fa fa-check"></i><b>9.1</b> 字符数统计</a></li>
<li class="chapter" data-level="9.2" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-translations"><i class="fa fa-check"></i><b>9.2</b> 字符串翻译</a></li>
<li class="chapter" data-level="9.3" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-concatenate"><i class="fa fa-check"></i><b>9.3</b> 字符串连接</a></li>
<li class="chapter" data-level="9.4" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-strsplit"><i class="fa fa-check"></i><b>9.4</b> 字符串拆分</a></li>
<li class="chapter" data-level="9.5" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-match"><i class="fa fa-check"></i><b>9.5</b> 字符串匹配</a></li>
<li class="chapter" data-level="9.6" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-search"><i class="fa fa-check"></i><b>9.6</b> 字符串查询</a></li>
<li class="chapter" data-level="9.7" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-replacement"><i class="fa fa-check"></i><b>9.7</b> 字符串替换</a></li>
<li class="chapter" data-level="9.8" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#base-extract"><i class="fa fa-check"></i><b>9.8</b> 字符串提取</a></li>
<li class="chapter" data-level="9.9" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#other-string-op"><i class="fa fa-check"></i><b>9.9</b> 其它字符串操作</a><ul>
<li class="chapter" data-level="9.9.1" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#strwrap"><i class="fa fa-check"></i><b>9.9.1</b> strwrap</a></li>
<li class="chapter" data-level="9.9.2" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#strtrim"><i class="fa fa-check"></i><b>9.9.2</b> strtrim</a></li>
<li class="chapter" data-level="9.9.3" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#strrep"><i class="fa fa-check"></i><b>9.9.3</b> strrep</a></li>
<li class="chapter" data-level="9.9.4" data-path="10-data-cleaning-with-string.html"><a href="10-data-cleaning-with-string.html#trimws"><i class="fa fa-check"></i><b>9.9.4</b> trimws</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="11-data-cleaning-with-stringr.html"><a href="11-data-cleaning-with-stringr.html"><i class="fa fa-check"></i><b>10</b> 数据清洁工</a><ul>
<li class="chapter" data-level="10.1" data-path="11-data-cleaning-with-stringr.html"><a href="11-data-cleaning-with-stringr.html#performance"><i class="fa fa-check"></i><b>10.1</b> 处理性能</a></li>
<li class="chapter" data-level="10.2" data-path="11-data-cleaning-with-stringr.html"><a href="11-data-cleaning-with-stringr.html#Web-crawler"><i class="fa fa-check"></i><b>10.2</b> 网络爬虫</a></li>
<li class="chapter" data-level="10.3" data-path="11-data-cleaning-with-stringr.html"><a href="11-data-cleaning-with-stringr.html#text-mining"><i class="fa fa-check"></i><b>10.3</b> 文本挖掘</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html"><i class="fa fa-check"></i><b>11</b> 正则表达式</a><ul>
<li class="chapter" data-level="11.1" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#character-constants"><i class="fa fa-check"></i><b>11.1</b> 字符常量</a></li>
<li class="chapter" data-level="11.2" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#environments"><i class="fa fa-check"></i><b>11.2</b> 软件环境</a></li>
<li class="chapter" data-level="11.3" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#foundations"><i class="fa fa-check"></i><b>11.3</b> 基本概念</a></li>
<li class="chapter" data-level="11.4" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#match"><i class="fa fa-check"></i><b>11.4</b> 字符串匹配</a></li>
<li class="chapter" data-level="11.5" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#concatenation"><i class="fa fa-check"></i><b>11.5</b> 级联表达式</a></li>
<li class="chapter" data-level="11.6" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#backreference"><i class="fa fa-check"></i><b>11.6</b> 反向引用</a></li>
<li class="chapter" data-level="11.7" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#named-capture"><i class="fa fa-check"></i><b>11.7</b> 命名捕捉</a></li>
<li class="chapter" data-level="11.8" data-path="12-data-cleaning-with-regexp.html"><a href="12-data-cleaning-with-regexp.html#comment"><i class="fa fa-check"></i><b>11.8</b> 表达式注释</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html"><i class="fa fa-check"></i><b>12</b> 绘图素材库</a><ul>
<li class="chapter" data-level="12.1" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#elements"><i class="fa fa-check"></i><b>12.1</b> 基本要素</a><ul>
<li class="chapter" data-level="12.1.1" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-points"><i class="fa fa-check"></i><b>12.1.1</b> 点线</a></li>
<li class="chapter" data-level="12.1.2" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-rect"><i class="fa fa-check"></i><b>12.1.2</b> 区域</a></li>
<li class="chapter" data-level="12.1.3" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-lines"><i class="fa fa-check"></i><b>12.1.3</b> 参考线</a></li>
<li class="chapter" data-level="12.1.4" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-axis"><i class="fa fa-check"></i><b>12.1.4</b> 坐标轴</a></li>
<li class="chapter" data-level="12.1.5" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-title"><i class="fa fa-check"></i><b>12.1.5</b> 标题</a></li>
<li class="chapter" data-level="12.1.6" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-annotation"><i class="fa fa-check"></i><b>12.1.6</b> 注释</a></li>
<li class="chapter" data-level="12.1.7" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-legend"><i class="fa fa-check"></i><b>12.1.7</b> 图例</a></li>
<li class="chapter" data-level="12.1.8" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-par"><i class="fa fa-check"></i><b>12.1.8</b> 边空</a></li>
<li class="chapter" data-level="12.1.9" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-layer"><i class="fa fa-check"></i><b>12.1.9</b> 图层</a></li>
<li class="chapter" data-level="12.1.10" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-layout"><i class="fa fa-check"></i><b>12.1.10</b> 布局</a></li>
<li class="chapter" data-level="12.1.11" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-combine"><i class="fa fa-check"></i><b>12.1.11</b> 组合</a></li>
<li class="chapter" data-level="12.1.12" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-screen"><i class="fa fa-check"></i><b>12.1.12</b> 分屏</a></li>
<li class="chapter" data-level="12.1.13" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#identify-locator"><i class="fa fa-check"></i><b>12.1.13</b> 交互</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-gallary"><i class="fa fa-check"></i><b>12.2</b> 统计图形</a><ul>
<li class="chapter" data-level="12.2.1" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-bar"><i class="fa fa-check"></i><b>12.2.1</b> 条形图</a></li>
<li class="chapter" data-level="12.2.2" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-hist"><i class="fa fa-check"></i><b>12.2.2</b> 直方图</a></li>
<li class="chapter" data-level="12.2.3" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-density"><i class="fa fa-check"></i><b>12.2.3</b> 密度图</a></li>
<li class="chapter" data-level="12.2.4" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-ecdf"><i class="fa fa-check"></i><b>12.2.4</b> 经验图</a></li>
<li class="chapter" data-level="12.2.5" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-qqnorm"><i class="fa fa-check"></i><b>12.2.5</b> QQ 图</a></li>
<li class="chapter" data-level="12.2.6" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-ts"><i class="fa fa-check"></i><b>12.2.6</b> 时序图</a></li>
<li class="chapter" data-level="12.2.7" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-pie"><i class="fa fa-check"></i><b>12.2.7</b> 饼图</a></li>
<li class="chapter" data-level="12.2.8" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-stem-leaf"><i class="fa fa-check"></i><b>12.2.8</b> 茎叶图</a></li>
<li class="chapter" data-level="12.2.9" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-scatter"><i class="fa fa-check"></i><b>12.2.9</b> 散点图</a></li>
<li class="chapter" data-level="12.2.10" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#base-jitter"><i class="fa fa-check"></i><b>12.2.10</b> 抖动图</a></li>
<li class="chapter" data-level="12.2.11" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-box"><i class="fa fa-check"></i><b>12.2.11</b> 箱线图</a></li>
<li class="chapter" data-level="12.2.12" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#error-bars"><i class="fa fa-check"></i><b>12.2.12</b> 残差图</a></li>
<li class="chapter" data-level="12.2.13" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-violin"><i class="fa fa-check"></i><b>12.2.13</b> 提琴图</a></li>
<li class="chapter" data-level="12.2.14" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-contour"><i class="fa fa-check"></i><b>12.2.14</b> 轮廓图</a></li>
<li class="chapter" data-level="12.2.15" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-line"><i class="fa fa-check"></i><b>12.2.15</b> 折线图</a></li>
<li class="chapter" data-level="12.2.16" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#function"><i class="fa fa-check"></i><b>12.2.16</b> 函数图</a></li>
<li class="chapter" data-level="12.2.17" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-mosaic"><i class="fa fa-check"></i><b>12.2.17</b> 马赛克图</a></li>
<li class="chapter" data-level="12.2.18" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#dotchart"><i class="fa fa-check"></i><b>12.2.18</b> 克利夫兰点图</a></li>
<li class="chapter" data-level="12.2.19" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-matrix"><i class="fa fa-check"></i><b>12.2.19</b> 矩阵图</a></li>
<li class="chapter" data-level="12.2.20" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-radar"><i class="fa fa-check"></i><b>12.2.20</b> 雷达图</a></li>
<li class="chapter" data-level="12.2.21" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-rose"><i class="fa fa-check"></i><b>12.2.21</b> 玫瑰图</a></li>
<li class="chapter" data-level="12.2.22" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#plot-map"><i class="fa fa-check"></i><b>12.2.22</b> 地形图</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#tikz"><i class="fa fa-check"></i><b>12.3</b> TikZ 绘图</a></li>
<li class="chapter" data-level="12.4" data-path="13-data-visualization-with-plot.html"><a href="13-data-visualization-with-plot.html#export-save"><i class="fa fa-check"></i><b>12.4</b> 图形导出</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="14-data-visualization-with-plot3d.html"><a href="14-data-visualization-with-plot3d.html"><i class="fa fa-check"></i><b>13</b> 三维可视化</a><ul>
<li class="chapter" data-level="13.1" data-path="14-data-visualization-with-plot3d.html"><a href="14-data-visualization-with-plot3d.html#pie-3d"><i class="fa fa-check"></i><b>13.1</b> 饼图</a></li>
<li class="chapter" data-level="13.2" data-path="14-data-visualization-with-plot3d.html"><a href="14-data-visualization-with-plot3d.html#bar-3d"><i class="fa fa-check"></i><b>13.2</b> 柱形图</a></li>
<li class="chapter" data-level="13.3" data-path="14-data-visualization-with-plot3d.html"><a href="14-data-visualization-with-plot3d.html#scatter-3d"><i class="fa fa-check"></i><b>13.3</b> 散点图</a></li>
<li class="chapter" data-level="13.4" data-path="14-data-visualization-with-plot3d.html"><a href="14-data-visualization-with-plot3d.html#curve-3d"><i class="fa fa-check"></i><b>13.4</b> 函数图</a></li>
<li class="chapter" data-level="13.5" data-path="14-data-visualization-with-plot3d.html"><a href="14-data-visualization-with-plot3d.html#persp-3d"><i class="fa fa-check"></i><b>13.5</b> 透视图</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>14</b> 数据可视化</a><ul>
<li class="chapter" data-level="14.1" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#intro-ggplot2"><i class="fa fa-check"></i><b>14.1</b> 基础语法</a><ul>
<li class="chapter" data-level="14.1.1" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-layer"><i class="fa fa-check"></i><b>14.1.1</b> 图层</a></li>
<li class="chapter" data-level="14.1.2" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-theme"><i class="fa fa-check"></i><b>14.1.2</b> 主题</a></li>
<li class="chapter" data-level="14.1.3" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-color"><i class="fa fa-check"></i><b>14.1.3</b> 配色</a></li>
<li class="chapter" data-level="14.1.4" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-scale"><i class="fa fa-check"></i><b>14.1.4</b> 刻度</a></li>
<li class="chapter" data-level="14.1.5" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-annotate"><i class="fa fa-check"></i><b>14.1.5</b> 注释</a></li>
<li class="chapter" data-level="14.1.6" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-legend"><i class="fa fa-check"></i><b>14.1.6</b> 图例</a></li>
<li class="chapter" data-level="14.1.7" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-grid"><i class="fa fa-check"></i><b>14.1.7</b> 组合</a></li>
<li class="chapter" data-level="14.1.8" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-coord"><i class="fa fa-check"></i><b>14.1.8</b> 坐标系</a></li>
<li class="chapter" data-level="14.1.9" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-axes"><i class="fa fa-check"></i><b>14.1.9</b> 坐标轴</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-gallary"><i class="fa fa-check"></i><b>14.2</b> 统计图形</a><ul>
<li class="chapter" data-level="14.2.1" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-scatter"><i class="fa fa-check"></i><b>14.2.1</b> 散点图</a></li>
<li class="chapter" data-level="14.2.2" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-boxplot"><i class="fa fa-check"></i><b>14.2.2</b> 箱线图</a></li>
<li class="chapter" data-level="14.2.3" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-barplot"><i class="fa fa-check"></i><b>14.2.3</b> 条形图</a></li>
<li class="chapter" data-level="14.2.4" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-line"><i class="fa fa-check"></i><b>14.2.4</b> 折线图</a></li>
<li class="chapter" data-level="14.2.5" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-histogram"><i class="fa fa-check"></i><b>14.2.5</b> 直方图</a></li>
<li class="chapter" data-level="14.2.6" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-violin"><i class="fa fa-check"></i><b>14.2.6</b> 提琴图</a></li>
<li class="chapter" data-level="14.2.7" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-jitter"><i class="fa fa-check"></i><b>14.2.7</b> 抖动图</a></li>
<li class="chapter" data-level="14.2.8" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-ridge"><i class="fa fa-check"></i><b>14.2.8</b> 密度图</a></li>
<li class="chapter" data-level="14.2.9" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-rose"><i class="fa fa-check"></i><b>14.2.9</b> 玫瑰图</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-spatial"><i class="fa fa-check"></i><b>14.3</b> 空间数据</a><ul>
<li class="chapter" data-level="14.3.1" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-raster"><i class="fa fa-check"></i><b>14.3.1</b> raster</a></li>
<li class="chapter" data-level="14.3.2" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-sp"><i class="fa fa-check"></i><b>14.3.2</b> sp</a></li>
<li class="chapter" data-level="14.3.3" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-sf"><i class="fa fa-check"></i><b>14.3.3</b> sf</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-network"><i class="fa fa-check"></i><b>14.4</b> 网络数据</a></li>
<li class="chapter" data-level="14.5" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#analysis-cran"><i class="fa fa-check"></i><b>14.5</b> CRAN 分析</a></li>
<li class="chapter" data-level="14.6" data-path="15-data-visualization-with-ggplot2.html"><a href="15-data-visualization-with-ggplot2.html#ggplot2-session-info"><i class="fa fa-check"></i><b>14.6</b> 软件信息</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="16-data-visualization-with-colors-fonts.html"><a href="16-data-visualization-with-colors-fonts.html"><i class="fa fa-check"></i><b>15</b> 色彩与字体</a><ul>
<li class="chapter" data-level="15.1" data-path="16-data-visualization-with-colors-fonts.html"><a href="16-data-visualization-with-colors-fonts.html#colors"><i class="fa fa-check"></i><b>15.1</b> 配色</a><ul>
<li class="chapter" data-level="15.1.1" data-path="16-data-visualization-with-colors-fonts.html"><a href="16-data-visualization-with-colors-fonts.html#colourlovers"><i class="fa fa-check"></i><b>15.1.1</b> colourlovers</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="16-data-visualization-with-colors-fonts.html"><a href="16-data-visualization-with-colors-fonts.html#fonts"><i class="fa fa-check"></i><b>15.2</b> 字体</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="99-references.html"><a href="99-references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://r4charts.netlify.com/" target="blank">Published with netlify</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">数据可视化与R语言</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graph-gallery" class="section level1">
<h1><span class="header-section-number">第 12 章</span> 绘图素材库</h1>
<div class="sidebar">
<p>作为知识介绍，本章所有数据都来源于基础 R 包，即安装 R 软件后自带的数据集，图库在以 base R 中的数据集介绍完后，以相应真实数据扩展为案列，结合统计意义和探索性数据分析介绍各种常见统计图形</p>
</div>
<p>数据可视化是一种重要的数据分析手段， R 提供了两套图形系统，分别是 graphics 包提供的基础绘图系统和 grid 包提供的栅格绘图系统，后者主要以两个 R 包为大家所熟知，一个是 lattice 包，另一个是 ggplot2 包。</p>
<p>Base 图形系统的扩展包 <a href="https://github.com/jumpingrivers/prettyB">prettyB</a> 和 <a href="https://github.com/pmur002/gridgraphics">gridGraphics</a></p>
<p>为了方便记忆函数 <code>par</code> 的各个参数，Paul Murrell 整理了一份 <a href="https://www.stat.auckland.ac.nz/~paul/R/parMemnonics.html">助记符</a>，此外，LaTeX 宏包 <a href="https://github.com/latexstudio/LaTeXPackages-CN">geometry</a> 对版面设置有很多专业的说明</p>
<div id="elements" class="section level2">
<h2><span class="header-section-number">12.1</span> 基本要素</h2>
<div id="base-points" class="section level3">
<h3><span class="header-section-number">12.1.1</span> 点线</h3>
<p>点和线是最常见的画图元素，在 <code>plot</code> 函数中，分别用参数 <code>pch</code> 和 <code>lty</code> 来设定类型，点的大小、线的宽度分别用参数 <code>cex</code> 和 <code>lwd</code> 来指定，颜色由参数 <code>col</code> 设置。参数 <code>type</code> 不同的值设置如下，<code>p</code> 显示点，<code>l</code> 绘制线，<code>b</code> 同时绘制空心点，并用线连接，<code>c</code> 只有线，<code>o</code> 在线上绘制点，<code>s</code> 和 <code>S</code> 点线连接绘制阶梯图，<code>h</code> 绘制类似直方图一样的垂线，最后 <code>n</code> 表示什么也不画。</p>
<p>点 points 、线 grid 背景线 abline lines rug 刻度线（线段segments、箭头arrows）、</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## -------- Showing all the extra &amp; some char graphics symbols ---------</span>
pchShow &lt;-
<span class="st">  </span><span class="cf">function</span>(<span class="dt">extras =</span> <span class="kw">c</span>(<span class="st">&quot;*&quot;</span>, <span class="st">&quot;.&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;|&quot;</span>, <span class="st">&quot;%&quot;</span>, <span class="st">&quot;#&quot;</span>),
             <span class="dt">cex =</span> <span class="dv">2</span>, <span class="co">## good for both .Device==&quot;postscript&quot; and &quot;x11&quot;</span>
             <span class="dt">col =</span> <span class="st">&quot;red3&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;gold&quot;</span>, <span class="dt">coltext =</span> <span class="st">&quot;brown&quot;</span>, <span class="dt">cextext =</span> <span class="fl">1.2</span>,
             <span class="dt">main =</span> <span class="kw">paste</span>(
               <span class="st">&quot;plot symbols :  points (...  pch = *, cex =&quot;</span>,
               cex, <span class="st">&quot;)&quot;</span>
             )) {
    nex &lt;-<span class="st"> </span><span class="kw">length</span>(extras)
    np &lt;-<span class="st"> </span><span class="dv">26</span> <span class="op">+</span><span class="st"> </span>nex
    ipch &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>(np <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)
    k &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">sqrt</span>(np))
    dd &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
    rx &lt;-<span class="st"> </span>dd <span class="op">+</span><span class="st"> </span><span class="kw">range</span>(ix &lt;-<span class="st"> </span>ipch <span class="op">%/%</span><span class="st"> </span>k)
    ry &lt;-<span class="st"> </span>dd <span class="op">+</span><span class="st"> </span><span class="kw">range</span>(iy &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span>(k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">-</span><span class="st"> </span>ipch <span class="op">%%</span><span class="st"> </span>k)
    pch &lt;-<span class="st"> </span><span class="kw">as.list</span>(ipch) <span class="co"># list with integers &amp; strings</span>
    <span class="cf">if</span> (nex <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) pch[<span class="dv">26</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span>nex] &lt;-<span class="st"> </span><span class="kw">as.list</span>(extras)
    <span class="kw">plot</span>(rx, ry, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> main)
    <span class="kw">abline</span>(<span class="dt">v =</span> ix, <span class="dt">h =</span> iy, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>)
    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>np) {
      pc &lt;-<span class="st"> </span>pch[[i]]
      <span class="co">## &#39;col&#39; symbols with a &#39;bg&#39;-colored interior (where available) :</span>
      <span class="kw">points</span>(ix[i], iy[i], <span class="dt">pch =</span> pc, <span class="dt">col =</span> col, <span class="dt">bg =</span> bg, <span class="dt">cex =</span> cex)
      <span class="cf">if</span> (cextext <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
        <span class="kw">text</span>(ix[i] <span class="op">-</span><span class="st"> </span><span class="fl">0.3</span>, iy[i], pc, <span class="dt">col =</span> coltext, <span class="dt">cex =</span> cextext)
      }
    }
  }

<span class="kw">pchShow</span>()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-2-1.png" alt="不同的 pch 参数值" width="70%" />
<p class="caption">
图 12.1: 不同的 pch 参数值
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## ------------ test code for various pch specifications -------------</span>
<span class="co"># Try this in various font families (including Hershey)</span>
<span class="co"># and locales.  Use sign = -1 asserts we want Latin-1.</span>
<span class="co"># Standard cases in a MBCS locale will not plot the top half.</span>
TestChars &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">sign =</span> <span class="dv">1</span>, <span class="dt">font =</span> <span class="dv">1</span>, ...) {
  MB &lt;-<span class="st"> </span><span class="kw">l10n_info</span>()<span class="op">$</span>MBCS
  r &lt;-<span class="st"> </span><span class="cf">if</span> (font <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) {
    sign &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="kw">c</span>(<span class="dv">32</span><span class="op">:</span><span class="dv">126</span>, <span class="dv">160</span><span class="op">:</span><span class="dv">254</span>)
  } <span class="cf">else</span> <span class="cf">if</span> (MB) <span class="dv">32</span><span class="op">:</span><span class="dv">126</span> <span class="cf">else</span> <span class="dv">32</span><span class="op">:</span><span class="dv">255</span>
  <span class="cf">if</span> (sign <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>) r &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">32</span><span class="op">:</span><span class="dv">126</span>, <span class="dv">160</span><span class="op">:</span><span class="dv">255</span>)
  <span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>)
  <span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">16</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">16</span>),
    <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
    <span class="dt">xaxs =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">yaxs =</span> <span class="st">&quot;i&quot;</span>,
    <span class="dt">main =</span> <span class="kw">sprintf</span>(<span class="st">&quot;sign = %d, font = %d&quot;</span>, sign, font)
  )
  <span class="kw">grid</span>(<span class="dv">17</span>, <span class="dv">17</span>, <span class="dt">lty =</span> <span class="dv">1</span>)
  <span class="kw">mtext</span>(<span class="kw">paste</span>(<span class="st">&quot;MBCS:&quot;</span>, MB))
  <span class="cf">for</span> (i <span class="cf">in</span> r) <span class="kw">try</span>(<span class="kw">points</span>(i <span class="op">%%</span><span class="st"> </span><span class="dv">16</span>, i <span class="op">%/%</span><span class="st"> </span><span class="dv">16</span>, <span class="dt">pch =</span> sign <span class="op">*</span><span class="st"> </span>i, <span class="dt">font =</span> font, ...))
}
<span class="kw">TestChars</span>()
<span class="kw">try</span>(<span class="kw">TestChars</span>(<span class="dt">sign =</span> <span class="dv">-1</span>))
<span class="kw">TestChars</span>(<span class="dt">font =</span> <span class="dv">5</span>) <span class="co"># Euro might be at 160 (0+10*16).</span>
<span class="co"># macOS has apple at 240 (0+15*16).</span>
<span class="kw">try</span>(<span class="kw">TestChars</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dt">font =</span> <span class="dv">2</span>)) <span class="co"># bold</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-3-1.png" alt="pch 支持的字符" width="45%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-3-2.png" alt="pch 支持的字符" width="45%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-3-3.png" alt="pch 支持的字符" width="45%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-3-4.png" alt="pch 支持的字符" width="45%" />
<p class="caption">
图 12.2: pch 支持的字符
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">12</span>
y &lt;-<span class="st"> </span><span class="kw">sin</span>(pi <span class="op">/</span><span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">mar =</span> <span class="fl">.1</span> <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))
<span class="cf">for</span> (tp <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;n&quot;</span>)) {
  <span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> tp, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;plot(*, type = </span><span class="ch">\&quot;</span><span class="st">&quot;</span>, tp, <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">)&quot;</span>))
  <span class="cf">if</span> (tp <span class="op">==</span><span class="st"> &quot;S&quot;</span>) {
    <span class="kw">lines</span>(x, y, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
    <span class="kw">mtext</span>(<span class="st">&quot;lines(*, type = </span><span class="ch">\&quot;</span><span class="st">s</span><span class="ch">\&quot;</span><span class="st">, ...)&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)
  }
}</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-4-1.png" alt="不同的 type 参数值" width="70%" />
<p class="caption">
图 12.3: 不同的 type 参数值
</p>
</div>
<p>颜色 col 连续型和离散型</p>
<p>线帽/端和字体的样式</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 合并为一个图 三条粗横线 横线上三种字形</span>
<span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>), <span class="dt">lwd =</span> <span class="dv">15</span>, <span class="dt">lend =</span> <span class="st">&quot;round&quot;</span>)
<span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="st">&quot;Hello, Helvetica&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">offset =</span> <span class="fl">1.5</span>)
<span class="kw">text</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;sans&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)
<span class="kw">text</span>(<span class="dv">15</span>, <span class="dv">5</span>, <span class="st">&quot;lend = round&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)

<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="dt">lwd =</span> <span class="dv">15</span>, <span class="dt">lend =</span> <span class="st">&quot;butt&quot;</span>)
<span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="st">&quot;Hello, Helvetica&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;mono&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">offset =</span> <span class="fl">1.5</span>)
<span class="kw">text</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="st">&quot;mono&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;mono&quot;</span>, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)
<span class="kw">text</span>(<span class="dv">15</span>, <span class="dv">10</span>, <span class="st">&quot;lend = butt&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)

<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">15</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">15</span>), <span class="dt">lwd =</span> <span class="dv">15</span>, <span class="dt">lend =</span> <span class="st">&quot;square&quot;</span>)
<span class="kw">text</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="st">&quot;Hello, Helvetica&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">offset =</span> <span class="fl">1.5</span>)
<span class="kw">text</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="st">&quot;serif&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">family =</span> <span class="st">&quot;serif&quot;</span>, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)
<span class="kw">text</span>(<span class="dv">15</span>, <span class="dv">15</span>, <span class="st">&quot;lend = square&quot;</span>, <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">offset =</span> <span class="fl">.5</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-5-1.png" alt="不同的线端样式" width="55%" />
<p class="caption">
图 12.4: 不同的线端样式
</p>
</div>
<p>lend：线端的样式，可用一个整数或字符串指定：</p>
<ul>
<li>0 或 “round” 圆形（默认）</li>
<li>1 或 “butt” 对接形</li>
<li>2 或 “square” 方形</li>
</ul>
</div>
<div id="base-rect" class="section level3">
<h3><span class="header-section-number">12.1.2</span> 区域</h3>
<p>矩形，多边形，曲线交汇出来的区域
面（矩形rect，多边形polygon）、路径 polypath
面/多边形 rect 颜色填充</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># From the manual</span>
ch.col &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">&quot;rainbow(n, start=.7, end=.1)&quot;</span>,
  <span class="st">&quot;heat.colors(n)&quot;</span>,
  <span class="st">&quot;terrain.colors(n)&quot;</span>,
  <span class="st">&quot;topo.colors(n)&quot;</span>,
  <span class="st">&quot;cm.colors(n)&quot;</span>
) <span class="co"># 选择颜色</span>
n &lt;-<span class="st"> </span><span class="dv">16</span>
nt &lt;-<span class="st"> </span><span class="kw">length</span>(ch.col)
i &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
j &lt;-<span class="st"> </span>n <span class="op">/</span><span class="st"> </span>nt
d &lt;-<span class="st"> </span>j <span class="op">/</span><span class="st"> </span><span class="dv">6</span>
dy &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>d
<span class="kw">plot</span>(i, i <span class="op">+</span><span class="st"> </span>d,
  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,
  <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;color palettes; n=&quot;</span>, n)
)
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nt) {
  <span class="kw">rect</span>(i <span class="op">-</span><span class="st"> </span><span class="fl">.5</span>, (k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>j <span class="op">+</span><span class="st"> </span>dy, i <span class="op">+</span><span class="st"> </span><span class="fl">.4</span>, k <span class="op">*</span><span class="st"> </span>j,
    <span class="dt">col =</span> <span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> ch.col[k]))
  ) <span class="co"># 咬人的函数/字符串解析为/转函数</span>
  <span class="kw">text</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>j, k <span class="op">*</span><span class="st"> </span>j <span class="op">+</span><span class="st"> </span>dy <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, ch.col[k])
}</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-6-1.png" alt="rect 函数画长方形" width="70%" />
<p class="caption">
图 12.5: rect 函数画长方形
</p>
</div>
<p><code>clip(x1, x2, y1, y2)</code> 在用户坐标中设置剪切区域</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)
<span class="kw">hist</span>(x, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>))
usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)
<span class="kw">clip</span>(usr[<span class="dv">1</span>], <span class="dv">-2</span>, usr[<span class="dv">3</span>], usr[<span class="dv">4</span>])
<span class="kw">hist</span>(x, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">clip</span>(<span class="dv">2</span>, usr[<span class="dv">2</span>], usr[<span class="dv">3</span>], usr[<span class="dv">4</span>])
<span class="kw">hist</span>(x, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
<span class="kw">do.call</span>(<span class="st">&quot;clip&quot;</span>, <span class="kw">as.list</span>(usr)) <span class="co"># reset to plot region</span></code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">my.col &lt;-<span class="st"> </span><span class="cf">function</span>(f, g, xmin, xmax, col, <span class="dt">N =</span> <span class="dv">200</span>,
                   <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>) {
  x &lt;-<span class="st"> </span><span class="kw">seq</span>(xmin, xmax, <span class="dt">length =</span> N)
  fx &lt;-<span class="st"> </span><span class="kw">f</span>(x)
  gx &lt;-<span class="st"> </span><span class="kw">g</span>(x)
  <span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>,
    <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,
    <span class="dt">xlim =</span> <span class="kw">c</span>(xmin, xmax),
    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(fx, gx), <span class="kw">max</span>(fx, gx)),
    <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> ylab, <span class="dt">main =</span> main
  )
  <span class="kw">polygon</span>(<span class="kw">c</span>(x, <span class="kw">rev</span>(x)), <span class="kw">c</span>(fx, <span class="kw">rev</span>(gx)),
    <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>, <span class="dt">border =</span> <span class="dv">0</span>
  )
  <span class="kw">lines</span>(x, fx, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;#34A853&quot;</span>)
  <span class="kw">lines</span>(x, gx, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;#4285f4&quot;</span>)
}
<span class="kw">my.col</span>(<span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>, <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(x),
  <span class="dv">-6</span>, <span class="dv">6</span>,
  <span class="dt">main =</span> <span class="st">&quot;The </span><span class="ch">\&quot;</span><span class="st">polygon</span><span class="ch">\&quot;</span><span class="st"> function&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-8-1.png" alt="区域重叠 polygon 函数" width="45%" />
<p class="caption">
图 12.6: 区域重叠 polygon 函数
</p>
</div>
<p>各种符号 <a href="13-data-visualization-with-plot.html#fig:cex-symbol">12.7</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>,
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>, <span class="dv">4</span>),
  <span class="dt">axes =</span> F,
  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>
)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>) {
  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {
    n &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>i <span class="op">+</span><span class="st"> </span>j
    <span class="kw">points</span>(j, i,
      <span class="dt">pch =</span> n,
      <span class="dt">cex =</span> <span class="dv">3</span>
    )
    <span class="kw">text</span>(j, i <span class="op">-</span><span class="st"> </span><span class="fl">.3</span>, <span class="kw">as.character</span>(n))
  }
}</code></pre>
<div class="figure" style="text-align: center"><span id="fig:cex-symbol"></span>
<img src="13-data-visualization-with-plot_files/figure-html/cex-symbol-1.png" alt="cex 支持的符号" width="55%" />
<p class="caption">
图 12.7: cex 支持的符号
</p>
</div>
<p>点、线、多边形和圆聚集在图 <a href="13-data-visualization-with-plot.html#fig:symbols">12.8</a> 中</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># https://jeroen.github.io/uros2018/#23</span>
<span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))
<span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">80</span>), <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">80</span>, <span class="dv">40</span>), <span class="dt">col =</span> <span class="st">&quot;hotpink&quot;</span>)
<span class="kw">text</span>(<span class="dv">40</span>, <span class="dv">90</span>, <span class="dt">labels =</span> <span class="st">&quot;My drawing&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;navyblue&quot;</span>, <span class="dt">cex =</span> <span class="dv">3</span>)
<span class="kw">symbols</span>(<span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>), <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">80</span>),
  <span class="dt">circles =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">10</span>),
  <span class="dt">bg =</span> <span class="kw">c</span>(<span class="st">&quot;#4285f4&quot;</span>, <span class="st">&quot;#EA4335&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:symbols"></span>
<img src="13-data-visualization-with-plot_files/figure-html/symbols-1.png" alt="多边形和符号元素" width="70%" />
<p class="caption">
图 12.8: 多边形和符号元素
</p>
</div>
<p>在介绍各种统计图形之前，先介绍几个绘图函数 <code>plot</code> 和 <code>text</code> 还有 <code>par</code> 参数设置， 作为最简单的开始，尽量依次介绍其中的每个参数的含义并附上图形对比。</p>
<pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>
<span class="kw">plot</span>(x, y, <span class="dt">ann =</span> F, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">text</span>(x, y,
  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1st&quot;</span>, <span class="st">&quot;2nd&quot;</span>, <span class="st">&quot;3rd&quot;</span>, <span class="st">&quot;4th&quot;</span>),
  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">offset =</span> <span class="fl">0.6</span>
)
ahat &lt;-<span class="st"> &quot;sigma&quot;</span>
<span class="co"># title(substitute(hat(a) == ahat, list(ahat = ahat)))</span>
<span class="kw">title</span>(<span class="kw">bquote</span>(<span class="kw">hat</span>(a) <span class="op">==</span><span class="st"> </span>.(ahat)))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:pos"></span>
<img src="13-data-visualization-with-plot_files/figure-html/pos-1.png" alt="pos 位置参数" width="55%" />
<p class="caption">
图 12.9: pos 位置参数
</p>
</div>
<p>其中 labels， pos 都是向量化的参数</p>
</div>
<div id="base-lines" class="section level3">
<h3><span class="header-section-number">12.1.3</span> 参考线</h3>
<p>矩形网格线是用做背景参考线的，常常是淡灰色的细密虚线，<code>plot</code> 函数的 <code>panel.first</code> 参数和 <code>grid</code> 函数常用来画这种参考线</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># modified from https://yihui.name/cn/2018/02/cohen-s-d/</span>
n =<span class="st"> </span><span class="dv">30</span>  <span class="co"># 样本量（只是一个例子）</span>
x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="fl">0.01</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>))
<span class="kw">plot</span>(x<span class="op">/</span><span class="kw">sqrt</span>(n), <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(x, n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)), 
     <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="dt">d =</span> x<span class="op">/</span><span class="kw">sqrt</span>(n)),
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>())
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:bg-grid-lines"></span>
<img src="13-data-visualization-with-plot_files/figure-html/bg-grid-lines-1.png" alt="添加背景参考线" width="70%" />
<p class="caption">
图 12.10: 添加背景参考线
</p>
</div>
</div>
<div id="base-axis" class="section level3">
<h3><span class="header-section-number">12.1.4</span> 坐标轴</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 双Y轴</span>
N &lt;-<span class="st"> </span><span class="dv">200</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">length =</span> N)
y1 &lt;-<span class="st"> </span><span class="kw">sin</span>(x)
y2 &lt;-<span class="st"> </span><span class="kw">cos</span>(x)
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>)) <span class="co"># Add some space in the right margin</span>
<span class="co"># The default is c(5,4,4,2) + .1</span>
xlim &lt;-<span class="st"> </span><span class="kw">range</span>(x)
ylim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>)
<span class="kw">plot</span>(x, y1,
  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim,
  <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Title&quot;</span>
)
<span class="kw">axis</span>(<span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(x, y2,
  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim,
  <span class="dt">axes =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>
)
<span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">mtext</span>(<span class="st">&quot;First Y axis&quot;</span>, <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Second Y axis&quot;</span>, <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="co"># 1,2,3,4 分别代表下左上右四个位置</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-9-1.png" alt="两个 Y 轴" width="55%" />
<p class="caption">
图 12.11: 两个 Y 轴
</p>
</div>
<p>调整坐标轴标签的距离</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Changing default gap between labels:</span>
<span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">ann=</span><span class="ot">FALSE</span>)
<span class="kw">title</span>(<span class="kw">quote</span>(<span class="st">&quot;axis(1, .., gap.axis = f),&quot;</span> <span class="op">~</span><span class="er">~</span><span class="st"> </span>f <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>))
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">5</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">gap.axis =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)
gaps &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="fl">0.1</span>, <span class="dv">0</span>)
chG &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">ifelse</span>(gaps <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;default:  &quot;</span>, <span class="st">&quot;&quot;</span>),
              <span class="st">&quot;gap.axis=&quot;</span>, <span class="kw">formatC</span>(gaps))
jj &lt;-<span class="st"> </span><span class="kw">seq_along</span>(gaps)
linG &lt;-<span class="st"> </span><span class="fl">-2.5</span><span class="op">*</span>(jj<span class="dv">-1</span>)
<span class="cf">for</span>(j <span class="cf">in</span> jj) {
    isD &lt;-<span class="st"> </span>gaps[j] <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="co"># is default</span>
    <span class="kw">axis</span> (<span class="dv">1</span>, <span class="dt">at=</span><span class="dv">5</span><span class="op">*</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>), <span class="dt">gap.axis =</span> gaps[j], <span class="dt">padj=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">line =</span> linG[j],
          <span class="dt">col.axis =</span> <span class="cf">if</span>(isD) <span class="st">&quot;forest green&quot;</span> <span class="cf">else</span> <span class="dv">1</span>, <span class="dt">font.axis=</span> <span class="dv">1</span><span class="op">+</span>isD)
}
<span class="kw">mtext</span>(chG, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">padj=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">line =</span> linG <span class="dv">-1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">cex=</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span>,
      <span class="dt">col =</span> <span class="kw">ifelse</span>(gaps <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;forest green&quot;</span>, <span class="st">&quot;blue3&quot;</span>))
<span class="co">## now shrink the window (in x- and y-direction) and observe the axis labels drawn</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:gap-axis"></span>
<img src="13-data-visualization-with-plot_files/figure-html/gap-axis-1.png" alt="gap.axis用法" width="55%" />
<p class="caption">
图 12.12: gap.axis用法
</p>
</div>
<p>旋转坐标轴标签</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Rotated axis labels in R plots</span>
<span class="co"># https://menugget.blogspot.com/2014/08/rotated-axis-labels-in-r-plots.html</span>
<span class="co"># Example data</span>
tmin &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2000-01-01&quot;</span>)
tmax &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2001-01-01&quot;</span>)
tlab &lt;-<span class="st"> </span><span class="kw">seq</span>(tmin, tmax, <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>)
lab &lt;-<span class="st"> </span><span class="kw">format</span>(tlab, <span class="dt">format =</span> <span class="st">&quot;%Y-%b&quot;</span>)
<span class="kw">set.seed</span>(<span class="dv">111</span>)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(tmin, tmax, <span class="dt">length.out =</span> <span class="dv">100</span>)
y &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))

<span class="co"># Plot</span>
<span class="co"># png(&quot;plot_w_rotated_axis_labels.png&quot;, height = 3,</span>
<span class="co">#     width = 6, units = &quot;in&quot;, res = 300)</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw">plot</span>(x, y, <span class="dt">t =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> tlab, <span class="dt">labels =</span> <span class="ot">FALSE</span>)
<span class="kw">text</span>(
  <span class="dt">x =</span> tlab, <span class="dt">y =</span> <span class="kw">par</span>()<span class="op">$</span>usr[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">par</span>()<span class="op">$</span>usr[<span class="dv">4</span>] <span class="op">-</span><span class="st"> </span><span class="kw">par</span>()<span class="op">$</span>usr[<span class="dv">3</span>]),
  <span class="dt">labels =</span> lab, <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>, <span class="dt">xpd =</span> <span class="ot">TRUE</span>
)
<span class="kw">par</span>(op)
<span class="co"># dev.off()</span></code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>旋转坐标抽标签的例子来自手册《R FAQ》的第7章第27个问题 <span class="citation">(Hornik <a href="#ref-R-FAQ" role="doc-biblioref">2018</a>)</span>，在基础图形中，旋转坐标轴标签需要 <code>text()</code> 而不是 <code>mtext()</code>，因为后者不支持<code>par("srt")</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Increase bottom margin to make room for rotated labels</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="fl">.5</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)
<span class="co">## Create plot with no x axis and no x axis label</span>
<span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)
<span class="co">## Set up x axis with tick marks alone</span>
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)
<span class="co">## Create some text labels</span>
labels &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Label&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)
<span class="co">## Plot x axis labels at default tick marks</span>
<span class="kw">text</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>,
  <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>,
  <span class="dt">labels =</span> labels, <span class="dt">xpd =</span> <span class="ot">TRUE</span>
)
<span class="co">## Plot x axis label at line 6 (of 7)</span>
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&quot;X Axis Label&quot;</span>, <span class="dt">line =</span> <span class="dv">4</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:rotate-axis-labels"></span>
<img src="13-data-visualization-with-plot_files/figure-html/rotate-axis-labels-1.png" alt="旋转坐标轴标签" width="70%" />
<p class="caption">
图 12.13: 旋转坐标轴标签
</p>
</div>
<p><code>srt = 45</code> 表示文本旋转角度， <code>xpd = TRUE</code> 允许文本越出绘图区域，<code>adj = 1</code> to place the right end of text at the tick marks；You can adjust the value of the 0.5 offset as required to move the axis labels up or down relative to the x axis. 详细地参考 <span class="citation">(Murrell <a href="#ref-Paul_2003_Integrating" role="doc-biblioref">2003</a>)</span></p>
</div>
<div id="base-title" class="section level3">
<h3><span class="header-section-number">12.1.5</span> 标题</h3>
<p>添加多个标题</p>
<pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">200</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dv">-4</span>, <span class="dv">4</span>)
y &lt;-<span class="st"> </span><span class="kw">sin</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(N)
<span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Subtitle&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">.8</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Title&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">mtext</span>(<span class="st">&quot;X axis&quot;</span>, <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">2.5</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">mtext</span>(<span class="st">&quot;X axis subtitle&quot;</span>, <span class="dv">1</span>, <span class="dt">line =</span> <span class="fl">3.7</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-11-1.png" alt="图标题/子标题 x轴标题/子标题" width="70%" />
<p class="caption">
图 12.14: 图标题/子标题 x轴标题/子标题
</p>
</div>
</div>
<div id="base-annotation" class="section level3">
<h3><span class="header-section-number">12.1.6</span> 注释</h3>
<p>数学符号注释，图<a href="13-data-visualization-with-plot.html#fig:math-annotation">12.15</a> 自定义坐标轴 <span class="citation">(Murrell and Ihaka <a href="#ref-Paul_2000_Approach" role="doc-biblioref">2000</a>)</span>。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 自定义坐标轴</span>
<span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1e6</span>), <span class="kw">c</span>(<span class="op">-</span>pi, pi),
  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>,
  <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">log =</span> <span class="st">&quot;x&quot;</span>
)
<span class="kw">axis</span>(<span class="dv">1</span>,
  <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1e2</span>, <span class="fl">1e4</span>, <span class="fl">1e6</span>),
  <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="dv">1</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">4</span>, <span class="dv">10</span><span class="op">^</span><span class="dv">6</span>)
)
<span class="kw">axis</span>(<span class="dv">2</span>,
  <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span>pi, <span class="op">-</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, pi),
  <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="op">-</span>pi, <span class="op">-</span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dv">0</span>, pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, pi)
)
<span class="kw">text</span>(<span class="fl">1e3</span>, <span class="dv">0</span>, <span class="kw">expression</span>(<span class="kw">italic</span>(<span class="st">&quot;Customized Axes&quot;</span>)))
<span class="kw">box</span>()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:math-annotation"></span>
<img src="13-data-visualization-with-plot_files/figure-html/math-annotation-1.png" alt="创建自定义的坐标轴和刻度标签" width="45%" />
<p class="caption">
图 12.15: 创建自定义的坐标轴和刻度标签
</p>
</div>
<p>在标题中添加数学公式</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length =</span> <span class="dv">200</span>)
y &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>))
)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="kw">expression</span>(
  <span class="st">&quot;graph of the function f&quot;</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)
))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-12-1.png" alt="标题含有数学公式" width="45%" />
<p class="caption">
图 12.16: 标题含有数学公式
</p>
</div>
<p>修改参数使用 <code>substitute</code> 函数批量生成</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">length =</span> <span class="dv">200</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) { <span class="co"># 画四个图</span>
  y &lt;-<span class="st"> </span><span class="kw">sqrt</span>(i <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
    <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>),
    <span class="dt">ylab =</span> <span class="kw">substitute</span>(
      <span class="kw">expression</span>(<span class="kw">sqrt</span>(i <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)),
      <span class="kw">list</span>(<span class="dt">i =</span> i)
    )
  )
  <span class="kw">title</span>(<span class="dt">main =</span> <span class="kw">substitute</span>(
    <span class="st">&quot;graph of the function f&quot;</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">sqrt</span>(i <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>),
    <span class="kw">list</span>(<span class="dt">i =</span> i)
  ))
}</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-13-1.png" alt="批量生成函数图形" width="45%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-13-2.png" alt="批量生成函数图形" width="45%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-13-3.png" alt="批量生成函数图形" width="45%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-13-4.png" alt="批量生成函数图形" width="45%" />
<p class="caption">
图 12.17: 批量生成函数图形
</p>
</div>
<p>基础绘图函数，如 plot 标签 <code>xlab</code> 支持 Unicode 代码表示的希腊字母，常用字母表备查，公式环境下，也可以用在绘图中</p>
<table>
<caption><span id="tab:letters">表 12.1: </span> 希腊字母表</caption>
<thead>
<tr class="header">
<th align="left">希腊字母</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
<th align="left">希腊字母</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="left"><code>\alpha</code></td>
<td align="left"><code>\u03B1</code></td>
<td align="left"><span class="math inline">\(\mu\)</span></td>
<td align="left"><code>\mu</code></td>
<td align="left"><code>\u03BC</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta\)</span></td>
<td align="left"><code>\beta</code></td>
<td align="left"><code>\u03B2</code></td>
<td align="left"><span class="math inline">\(\nu\)</span></td>
<td align="left"><code>\nu</code></td>
<td align="left"><code>\u03BD</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\gamma\)</span></td>
<td align="left"><code>\gamma</code></td>
<td align="left"><code>\u03B3</code></td>
<td align="left"><span class="math inline">\(\xi\)</span></td>
<td align="left"><code>\xi</code></td>
<td align="left"><code>\u03BE</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\delta\)</span></td>
<td align="left"><code>\delta</code></td>
<td align="left"><code>\u03B4</code></td>
<td align="left"><span class="math inline">\(\varphi\)</span></td>
<td align="left"><code>\varphi</code></td>
<td align="left"><code>\u03C6</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\epsilon\)</span></td>
<td align="left"><code>\epsilon</code></td>
<td align="left"><code>\u03B5</code></td>
<td align="left"><span class="math inline">\(\pi\)</span></td>
<td align="left"><code>\pi</code></td>
<td align="left"><code>\u03C0</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\zeta\)</span></td>
<td align="left"><code>\zeta</code></td>
<td align="left"><code>\u03B6</code></td>
<td align="left"><span class="math inline">\(\rho\)</span></td>
<td align="left"><code>\rho</code></td>
<td align="left"><code>\u03C1</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\eta\)</span></td>
<td align="left"><code>\eta</code></td>
<td align="left"><code>\u03B7</code></td>
<td align="left"><span class="math inline">\(\upsilon\)</span></td>
<td align="left"><code>\upsilon</code></td>
<td align="left"><code>\u03C5</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\theta\)</span></td>
<td align="left"><code>\theta</code></td>
<td align="left"><code>\u03B8</code></td>
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="left"><code>\phi</code></td>
<td align="left"><code>\u03C6</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\iota\)</span></td>
<td align="left"><code>\iota</code></td>
<td align="left"><code>\u03B9</code></td>
<td align="left"><span class="math inline">\(\chi\)</span></td>
<td align="left"><code>\chi</code></td>
<td align="left"><code>\u03C7</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\kappa\)</span></td>
<td align="left"><code>\kappa</code></td>
<td align="left"><code>\u03BA</code></td>
<td align="left"><span class="math inline">\(\psi\)</span></td>
<td align="left"><code>\psi</code></td>
<td align="left"><code>\u03C8</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\lambda\)</span></td>
<td align="left"><code>\lambda</code></td>
<td align="left"><code>\u03BB</code></td>
<td align="left"><span class="math inline">\(\omega\)</span></td>
<td align="left"><code>\omega</code></td>
<td align="left"><code>\u03C9</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma\)</span></td>
<td align="left"><code>\sigma</code></td>
<td align="left"><code>\u03C3</code></td>
<td align="left"><span class="math inline">\(\tau\)</span></td>
<td align="left"><code>\tau</code></td>
<td align="left"><code>\u03C4</code></td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:super-sub-script">表 12.2: </span> 数字上下标</caption>
<thead>
<tr class="header">
<th align="left">上标数字</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
<th align="left">下标数字</th>
<th align="left">LaTeX 代码</th>
<th align="left">Unicode 代码</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\({}^0\)</span></td>
<td align="left"><code>{}^0</code></td>
<td align="left"><code>\u2070</code></td>
<td align="left"><span class="math inline">\({}_0\)</span></td>
<td align="left"><code>{}_0</code></td>
<td align="left"><code>\u2080</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^1\)</span></td>
<td align="left"><code>{}^1</code></td>
<td align="left"><code>\u00B9</code></td>
<td align="left"><span class="math inline">\({}_1\)</span></td>
<td align="left"><code>{}_1</code></td>
<td align="left"><code>\u2081</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^2\)</span></td>
<td align="left"><code>{}^2</code></td>
<td align="left"><code>\u00B2</code></td>
<td align="left"><span class="math inline">\({}_2\)</span></td>
<td align="left"><code>{}_2</code></td>
<td align="left"><code>\u2082</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^3\)</span></td>
<td align="left"><code>{}^3</code></td>
<td align="left"><code>\u00B2</code></td>
<td align="left"><span class="math inline">\({}_3\)</span></td>
<td align="left"><code>{}_3</code></td>
<td align="left"><code>\u2083</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^4\)</span></td>
<td align="left"><code>{}^4</code></td>
<td align="left"><code>\u2074</code></td>
<td align="left"><span class="math inline">\({}_4\)</span></td>
<td align="left"><code>{}_4</code></td>
<td align="left"><code>\u2084</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^5\)</span></td>
<td align="left"><code>{}^5</code></td>
<td align="left"><code>\u2075</code></td>
<td align="left"><span class="math inline">\({}_5\)</span></td>
<td align="left"><code>{}_5</code></td>
<td align="left"><code>\u2085</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^6\)</span></td>
<td align="left"><code>{}^6</code></td>
<td align="left"><code>\u2076</code></td>
<td align="left"><span class="math inline">\({}_6\)</span></td>
<td align="left"><code>{}_6</code></td>
<td align="left"><code>\u2086</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^7\)</span></td>
<td align="left"><code>{}^7</code></td>
<td align="left"><code>\u2077</code></td>
<td align="left"><span class="math inline">\({}_7\)</span></td>
<td align="left"><code>{}_7</code></td>
<td align="left"><code>\u2087</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^8\)</span></td>
<td align="left"><code>{}^8</code></td>
<td align="left"><code>\u2078</code></td>
<td align="left"><span class="math inline">\({}_8\)</span></td>
<td align="left"><code>{}_8</code></td>
<td align="left"><code>\u2088</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\({}^9\)</span></td>
<td align="left"><code>{}^9</code></td>
<td align="left"><code>\u2079</code></td>
<td align="left"><span class="math inline">\({}_9\)</span></td>
<td align="left"><code>{}_9</code></td>
<td align="left"><code>\u2089</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\({}^n\)</span></td>
<td align="left"><code>{}^n</code></td>
<td align="left"><code>\u207F</code></td>
<td align="left"><span class="math inline">\({}_n\)</span></td>
<td align="left"><code>{}_n</code></td>
<td align="left">-</td>
</tr>
</tbody>
</table>
<p>其它字母，请查看 <a href="https://www.ssec.wisc.edu/~tomw/java/unicode.html">Unicode 字母表</a></p>
</div>
<div id="base-legend" class="section level3">
<h3><span class="header-section-number">12.1.7</span> 图例</h3>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dt">length =</span> <span class="dv">200</span>)
y &lt;-<span class="st"> </span><span class="kw">sin</span>(x)
z &lt;-<span class="st"> </span><span class="kw">cos</span>(x)
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span>
)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">-1</span>,
  <span class="dt">yjust =</span> <span class="dv">0</span>,
  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),
  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-14-1.png" alt="三角函数添加图例" width="70%" />
<p class="caption">
图 12.18: 三角函数添加图例
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">xmin &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>]
xmax &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>]
ymin &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>]
ymax &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>]

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span>
)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,
  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),
  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-15-1.png" alt="设置图例的位置" width="70%" />
<p class="caption">
图 12.19: 设置图例的位置
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span>
)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,
  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),
  <span class="dt">inset =</span> <span class="kw">c</span>(.<span class="dv">03</span>, <span class="fl">.03</span>),
  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-16-1.png" alt="insert 函数微调图例位置" width="70%" />
<p class="caption">
图 12.20: insert 函数微调图例位置
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;angle&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Trigonometric functions&quot;</span>
)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(z <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">par</span>(<span class="dt">xpd =</span> <span class="ot">TRUE</span>) <span class="co"># Do not clip to the drawing area 关键一行/允许出界</span>
lambda &lt;-<span class="st"> </span><span class="fl">.025</span>
<span class="kw">legend</span>(<span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>],
  (<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>lambda) <span class="op">*</span><span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>] <span class="op">-</span><span class="st"> </span>lambda <span class="op">*</span><span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>],
  <span class="kw">c</span>(<span class="st">&quot;Sine&quot;</span>, <span class="st">&quot;Cosine&quot;</span>),
  <span class="dt">xjust =</span> <span class="dv">0</span>, <span class="dt">yjust =</span> <span class="dv">0</span>,
  <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">par</span>(<span class="st">&quot;fg&quot;</span>), <span class="st">&quot;red&quot;</span>)
)
<span class="kw">par</span>(op)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-17"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-17-1.png" alt="将图例放在绘图区域外面" width="70%" />
<p class="caption">
图 12.21: 将图例放在绘图区域外面
</p>
</div>
<p>Hmisc 包的 labcurve 函数可以在曲线上放置名称，而不是遥远的图例上</p>
</div>
<div id="base-par" class="section level3">
<h3><span class="header-section-number">12.1.8</span> 边空</h3>
<pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">200</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dv">-4</span>, <span class="dv">4</span>)
y &lt;-<span class="st"> </span><span class="kw">sin</span>(x) <span class="op">+</span><span class="st"> </span><span class="fl">.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(N)
<span class="kw">plot</span>(x, y,
  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">main =</span> <span class="kw">paste</span>(
    <span class="st">&quot;The </span><span class="ch">\&quot;</span><span class="st">mtext</span><span class="ch">\&quot;</span><span class="st"> function&quot;</span>,
    <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&quot; &quot;</span>, <span class="dv">60</span>), <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)
  )
)
<span class="kw">mtext</span>(<span class="st">&quot;Line 0&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">0</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Line 1&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Line 2&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">2</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Line 3&quot;</span>, <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">3</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-18"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-18-1.png" alt="外边空在图的边缘添加文字" width="70%" />
<p class="caption">
图 12.22: 外边空在图的边缘添加文字
</p>
</div>
<p><code>par</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 多图排列/分屏 page 47</span>
<span class="co"># 最常用的是 par mfrow mfcol分别按行/列放置图形</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(
  <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
  <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>) <span class="co"># Outer margins</span>
)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
  <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>),
    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;random plot (&quot;</span>, i, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  )
<span class="kw">par</span>(op)
<span class="kw">mtext</span>(<span class="st">&quot;Four plots, without enough room for this title&quot;</span>,
  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">font =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>
) <span class="co"># 总/大标题放不下</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-19"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-19-1.png" alt="多图排列共享一个大标题" width="70%" />
<p class="caption">
图 12.23: 多图排列共享一个大标题
</p>
</div>
<p><code>par</code> 的 oma 用来设置外边空的大小</p>
<pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(
  <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
  <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>) <span class="co"># Outer margins</span>
)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
  <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>),
    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;random plot (&quot;</span>, i, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  )
<span class="kw">par</span>(op)
<span class="kw">mtext</span>(<span class="st">&quot;Four plots, with some room for this title&quot;</span>,
  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">font =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-20"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-20-1.png" alt="设置外边空放置大标题" width="70%" />
<p class="caption">
图 12.24: 设置外边空放置大标题
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(
  <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
  <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>),
  <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">.1</span> <span class="co"># Margins</span>
)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
  <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>),
    <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;random plot (&quot;</span>, i, <span class="st">&quot;)&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
  )
<span class="kw">par</span>(op)
<span class="kw">mtext</span>(<span class="st">&quot;Title&quot;</span>,
  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">font =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-21"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-21-1.png" alt="设置每个子图的边空 mar" width="70%" />
<p class="caption">
图 12.25: 设置每个子图的边空 mar
</p>
</div>
</div>
<div id="base-layer" class="section level3">
<h3><span class="header-section-number">12.1.9</span> 图层</h3>
<p>覆盖图形 <code>add = T</code> or <code>par(new=TRUE)</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>),
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)
)
<span class="kw">points</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>),
  <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">3</span>
)
<span class="kw">lines</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">segments</span>(<span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>),
  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>
)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Overlaying points, segments, lines...&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-22"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-22-1.png" alt="添加图层" width="70%" />
<p class="caption">
图 12.26: 添加图层
</p>
</div>
</div>
<div id="base-layout" class="section level3">
<h3><span class="header-section-number">12.1.10</span> 布局</h3>
<p><code>layout</code> 函数布局， 绘制复杂组合图形</p>
<pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>))
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(
  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,
  <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>,
  <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>
), <span class="dt">nr =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))
<span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)
<span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)
<span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)
<span class="kw">hist</span>(<span class="kw">rnorm</span>(n), <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>)
<span class="kw">mtext</span>(<span class="st">&quot;The </span><span class="ch">\&quot;</span><span class="st">layout</span><span class="ch">\&quot;</span><span class="st"> function&quot;</span>,
  <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>,
  <span class="dt">font =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-23"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-23-1.png" alt="更加复杂的组合图形" width="70%" />
<p class="caption">
图 12.27: 更加复杂的组合图形
</p>
</div>
</div>
<div id="base-combine" class="section level3">
<h3><span class="header-section-number">12.1.11</span> 组合</h3>
<p><code>par</code> 之 <code>fig</code> 参数很神奇，使得多个图可以叠加在一起，它接受一个数值向量<code>c(x1, x2, y1, y2)</code> ，是图形设备显示区域中的绘图区域的(NDC, normalized device coordinates)坐标。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,
  <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&#39;fg&#39; : axes, ticks and box in gray&quot;</span>,
  <span class="dt">fg =</span> <span class="kw">gray</span>(<span class="fl">0.7</span>), <span class="dt">bty =</span> <span class="st">&quot;7&quot;</span>, <span class="dt">sub =</span> R.version.string
)
<span class="kw">par</span>(<span class="dt">fig =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="op">/</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">new =</span> T)
<span class="kw">plot</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>,
  <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">fg =</span> <span class="kw">gray</span>(<span class="fl">0.7</span>), <span class="dt">bty =</span> <span class="st">&quot;7&quot;</span>, <span class="dt">xlab =</span> R.version.string
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-24-1.png" alt="多图叠加" width="70%" />
<p class="caption">
图 12.28: 多图叠加
</p>
</div>
<p><code>fig</code> 参数控制图形的位置，用来绘制组合图形</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">1000</span>
x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> <span class="dv">10</span>)
<span class="kw">hist</span>(x,
  <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>,
  <span class="dt">probability =</span> <span class="st">&quot;TRUE&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span> <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">density</span>(x)<span class="op">$</span>y))
)
<span class="kw">lines</span>(<span class="kw">density</span>(x),
  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,
  <span class="dt">lwd =</span> <span class="dv">3</span>
)
op &lt;-<span class="st"> </span><span class="kw">par</span>(
  <span class="dt">fig =</span> <span class="kw">c</span>(.<span class="dv">02</span>, <span class="fl">.4</span>, <span class="fl">.5</span>, <span class="fl">.98</span>),
  <span class="dt">new =</span> <span class="ot">TRUE</span>
)
<span class="kw">qqnorm</span>(x,
  <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">axes =</span> <span class="ot">FALSE</span>
)
<span class="kw">qqline</span>(x, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">box</span>(<span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">par</span>(op)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-25"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-25-1.png" alt="组合图形" width="70%" />
<p class="caption">
图 12.29: 组合图形
</p>
</div>
</div>
<div id="base-screen" class="section level3">
<h3><span class="header-section-number">12.1.12</span> 分屏</h3>
<p><code>split.screen</code> 分屏组合</p>
<pre class="sourceCode r"><code class="sourceCode r">random.plot &lt;-<span class="st"> </span><span class="cf">function</span>() {
  N &lt;-<span class="st"> </span><span class="dv">200</span>
  f &lt;-<span class="st"> </span><span class="kw">sample</span>(
    <span class="kw">list</span>(
      rnorm,
      <span class="cf">function</span>(x) {
        <span class="kw">rt</span>(x, <span class="dt">df =</span> <span class="dv">2</span>)
      },
      rlnorm,
      runif
    ),
    <span class="dv">1</span>
  ) [[<span class="dv">1</span>]]
  x &lt;-<span class="st"> </span><span class="kw">f</span>(N)
  <span class="kw">hist</span>(x, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> F)
  <span class="kw">axis</span>(<span class="dv">1</span>)
}
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">split.screen</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="co">#&gt; [1] 1 2</span>
<span class="kw">split.screen</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">screen =</span> <span class="dv">2</span>)
<span class="co">#&gt; [1] 3 4 5</span>
<span class="kw">screen</span>(<span class="dv">1</span>)
<span class="kw">random.plot</span>()
<span class="co"># screen(2); random.plot() # Screen 2 was split into three screens: 3, 4, 5</span>
<span class="kw">screen</span>(<span class="dv">3</span>)
<span class="kw">random.plot</span>()
<span class="kw">screen</span>(<span class="dv">4</span>)
<span class="kw">random.plot</span>()
<span class="kw">screen</span>(<span class="dv">5</span>)
<span class="kw">random.plot</span>()
<span class="kw">close.screen</span>(<span class="dt">all =</span> <span class="ot">TRUE</span>)
<span class="kw">par</span>(op)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-26"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-26-1.png" alt="分屏" width="70%" />
<p class="caption">
图 12.30: 分屏
</p>
</div>
</div>
<div id="identify-locator" class="section level3">
<h3><span class="header-section-number">12.1.13</span> 交互</h3>
<p>辅助绘图 identify locator</p>
</div>
</div>
<div id="plot-gallary" class="section level2">
<h2><span class="header-section-number">12.2</span> 统计图形</h2>
<p>按图的类型划分，最后在小结部分给出各图适用的数据类型</p>
<p>根据数据类型划分： 对于一元数据，可用什么图来描述；多元数据呢，连续数据和离散数据（分类数据）</p>
<p>先找一个不重不漏的划分，指导原则是根据数据类型选择图，根据探索到的数据中的规律，选择图</p>
<p>其它 assocplot fourfoldplot sunflowerplot</p>
<div id="plot-bar" class="section level3">
<h3><span class="header-section-number">12.2.1</span> 条形图</h3>
<p><a href="https://rpubs.com/chidungkt/392980">条形图</a></p>
<p>简单条形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(diamonds, <span class="dt">package =</span> <span class="st">&quot;ggplot2&quot;</span>) <span class="co"># 加载数据</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>))
barCenters &lt;-<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">table</span>(diamonds<span class="op">$</span>cut),
  <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>,
  <span class="dt">axisnames =</span> <span class="ot">FALSE</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>
)
<span class="kw">text</span>(
  <span class="dt">y =</span> barCenters, <span class="dt">x =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>],
  <span class="dt">adj =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">names</span>(<span class="kw">table</span>(diamonds<span class="op">$</span>cut)), <span class="dt">xpd =</span> <span class="ot">TRUE</span>
)
<span class="kw">axis</span>(<span class="dv">1</span>,
  <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25000</span>, <span class="dt">by =</span> <span class="dv">5000</span>), <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25000</span>, <span class="dt">by =</span> <span class="dv">5000</span>),
  <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>
)
<span class="kw">grid</span>()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:diamonds-base-barplot"></span>
<img src="13-data-visualization-with-plot_files/figure-html/diamonds-base-barplot-1.png" alt="条形图" width="70%" />
<p class="caption">
图 12.31: 条形图
</p>
</div>
<p>简单柱形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123456</span>)
barPois &lt;-<span class="st"> </span><span class="kw">table</span>(stats<span class="op">::</span><span class="kw">rpois</span>(<span class="dv">1000</span>, <span class="dt">lambda =</span> <span class="dv">5</span>))
<span class="kw">plot</span>(barPois, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-27"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-27-1.png" alt="柱形图" width="70%" />
<p class="caption">
图 12.32: 柱形图
</p>
</div>
<p>复合条形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>,<span class="fl">2.1</span>,<span class="fl">0.5</span>,<span class="fl">4.5</span>))
<span class="kw">barplot</span>(VADeaths, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">5</span>),
        <span class="dt">legend.text =</span> <span class="kw">rownames</span>(VADeaths), <span class="dt">xpd =</span> <span class="ot">TRUE</span>, <span class="dt">beside =</span> <span class="ot">TRUE</span>,
        <span class="dt">cex.names =</span> <span class="fl">0.9</span>,
        <span class="dt">args.legend =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="st">&quot;right&quot;</span>,<span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Age&quot;</span>,
                           <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="dv">0</span>),
                           <span class="dt">xpd =</span> <span class="ot">TRUE</span>), 
        <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">nx =</span> <span class="dv">0</span>, <span class="dt">ny=</span><span class="dv">7</span>)) </code></pre>
<div class="figure" style="text-align: center"><span id="fig:barplot-VADeaths-1"></span>
<img src="13-data-visualization-with-plot_files/figure-html/barplot-VADeaths-1-1.png" alt="复合条形图" width="70%" />
<p class="caption">
图 12.33: 复合条形图
</p>
</div>
<p>堆积条形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>,<span class="fl">2.1</span>,<span class="fl">0.5</span>,<span class="fl">4.5</span>))
<span class="kw">barplot</span>(VADeaths, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">5</span>),
        <span class="dt">legend.text =</span> <span class="kw">rownames</span>(VADeaths), <span class="dt">xpd =</span> <span class="ot">TRUE</span>, <span class="dt">beside =</span> <span class="ot">FALSE</span>,
        <span class="dt">cex.names =</span> <span class="fl">0.9</span>,
        <span class="dt">args.legend =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="st">&quot;right&quot;</span>,<span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Age&quot;</span>,
                           <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">2</span>, <span class="dv">0</span>),
                           <span class="dt">xpd =</span> <span class="ot">TRUE</span>), 
        <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">nx =</span> <span class="dv">0</span>, <span class="dt">ny=</span><span class="dv">4</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:barplot-VADeaths-2"></span>
<img src="13-data-visualization-with-plot_files/figure-html/barplot-VADeaths-2-1.png" alt="堆积条形图" width="70%" />
<p class="caption">
图 12.34: 堆积条形图
</p>
</div>
<ul>
<li>堆积条形图 spineplot</li>
</ul>
<p>简单条形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="dt">data =</span> BOD, demand <span class="op">~</span><span class="st"> </span>Time, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),
        <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">1</span>))</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/barplot-BOD-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">pg_mean =<span class="st"> </span><span class="kw">aggregate</span>(weight <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> PlantGrowth, mean)
<span class="kw">barplot</span>(<span class="dt">data =</span> pg_mean, weight <span class="op">~</span><span class="st"> </span>group,
        <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">3</span>))</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/barplot-PlantGrowth-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Titanic 数据集是 table 数据类型</p>
<p>简单条形图</p>
<p>复合条形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(Freq <span class="op">~</span><span class="st"> </span>Class <span class="op">+</span><span class="st"> </span>Survived, <span class="dt">data =</span> Titanic,
        <span class="dt">subset =</span> Age <span class="op">==</span><span class="st"> &quot;Adult&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Sex <span class="op">==</span><span class="st"> &quot;Male&quot;</span>,
        <span class="dt">beside =</span> <span class="ot">TRUE</span>,
        <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">4</span>),
        <span class="dt">args.legend =</span> <span class="kw">list</span>(<span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Class&quot;</span>,
                           <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>,
                           <span class="dt">xpd =</span> <span class="ot">TRUE</span>),   
        <span class="dt">ylab =</span> <span class="st">&quot;# {passengers}&quot;</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>堆积条形图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(Freq <span class="op">~</span><span class="st"> </span>Class <span class="op">+</span><span class="st"> </span>Survived, <span class="dt">data =</span> Titanic,
        <span class="dt">subset =</span> Age <span class="op">==</span><span class="st"> &quot;Adult&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Sex <span class="op">==</span><span class="st"> &quot;Male&quot;</span>,
        <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">4</span>),
        <span class="dt">args.legend =</span> <span class="kw">list</span>(<span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Class&quot;</span>,
                           <span class="dt">box.col =</span> <span class="ot">NA</span>, <span class="dt">horiz =</span> <span class="ot">FALSE</span>,
                           <span class="dt">xpd =</span> <span class="ot">TRUE</span>),         
        <span class="dt">ylab =</span> <span class="st">&quot;# {passengers}&quot;</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-hist" class="section level3">
<h3><span class="header-section-number">12.2.2</span> 直方图</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
n &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">24</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)
delta &lt;-<span class="st"> </span><span class="fl">0.01</span>
len &lt;-<span class="st"> </span><span class="kw">diff</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span>delta), n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
ylim &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1800</span>, <span class="dt">by =</span> <span class="dv">300</span>)
xlim &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">20</span>)
p &lt;-<span class="st"> </span><span class="kw">hist</span>(len[len <span class="op">&lt;</span><span class="st"> </span><span class="dv">101</span>], <span class="dt">breaks =</span> <span class="dv">-1</span><span class="op">:</span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
<span class="kw">plot</span>(p, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> xlim, <span class="dt">at =</span> xlim, <span class="dt">las =</span> <span class="dv">1</span>) <span class="co"># x 轴</span>
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">labels =</span> ylim, <span class="dt">at =</span> ylim, <span class="dt">las =</span> <span class="dv">0</span>) <span class="co"># y 轴</span>
<span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-30"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-30-1.png" alt="直方图" width="55%" />
<p class="caption">
图 12.35: 直方图
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(<span class="dt">data =</span> faithful, {
  <span class="kw">hist</span>(eruptions, <span class="kw">seq</span>(<span class="fl">1.6</span>, <span class="fl">5.2</span>, <span class="fl">0.2</span>), <span class="dt">prob =</span> <span class="ot">TRUE</span>, 
       <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>)
  <span class="kw">lines</span>(<span class="kw">density</span>(eruptions, <span class="dt">bw =</span> <span class="fl">0.1</span>), <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>)
  <span class="kw">rug</span>(eruptions, <span class="dt">col =</span> <span class="st">&quot;#EA4335&quot;</span>) <span class="co"># 添加数据点</span>
})</code></pre>
<div class="figure" style="text-align: center"><span id="fig:eruptions"></span>
<img src="13-data-visualization-with-plot_files/figure-html/eruptions-1.png" alt="老忠实泉间歇性喷水的时间间隔分布" width="70%" />
<p class="caption">
图 12.36: 老忠实泉间歇性喷水的时间间隔分布
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(longley<span class="op">$</span>Unemployed,
  <span class="dt">probability =</span> <span class="ot">TRUE</span>,
  <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>
)
<span class="co"># 添加密度估计</span>
<span class="kw">lines</span>(<span class="kw">density</span>(longley<span class="op">$</span>Unemployed),
  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,
  <span class="dt">lwd =</span> <span class="dv">3</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-31"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-31-1.png" alt="概率密度分布" width="70%" />
<p class="caption">
图 12.37: 概率密度分布
</p>
</div>
<p>直方图有很多花样的，添加阴影线，angle 控制倾斜的角度</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># hist(longley$Unemployed, density = 1, angle = 45)</span>
<span class="co"># hist(longley$Unemployed, density = 3, angle = 15)</span>
<span class="co"># hist(longley$Unemployed, density = 1, angle = 15)</span>
<span class="kw">hist</span>(longley<span class="op">$</span>Unemployed, <span class="dt">density =</span> <span class="dv">3</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-32"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-32-1.png" alt="density 数值越大阴影线越密" width="70%" />
<p class="caption">
图 12.38: density 数值越大阴影线越密
</p>
</div>
</div>
<div id="plot-density" class="section level3">
<h3><span class="header-section-number">12.2.3</span> 密度图</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">data</span>(galaxies)
galaxies &lt;-<span class="st"> </span>galaxies <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>
<span class="co"># Bandwidth Selection by Pilot Estimation of Derivatives</span>
<span class="kw">c</span>(<span class="kw">width.SJ</span>(galaxies, <span class="dt">method =</span> <span class="st">&quot;dpi&quot;</span>), <span class="kw">width.SJ</span>(galaxies))
<span class="co">#&gt; [1] 3.26 2.57</span>
<span class="kw">plot</span>(
  <span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">40</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;velocity of galaxy (km/s)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;density&quot;</span>
)
<span class="kw">rug</span>(galaxies)
<span class="kw">lines</span>(<span class="kw">density</span>(galaxies, <span class="dt">width =</span> <span class="fl">3.25</span>, <span class="dt">n =</span> <span class="dv">200</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(galaxies, <span class="dt">width =</span> <span class="fl">2.56</span>, <span class="dt">n =</span> <span class="dv">200</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">110</span>, <span class="dt">to =</span> <span class="dv">174</span>, <span class="dt">by =</span> <span class="fl">0.5</span>)
y1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">145</span>, <span class="dt">sd =</span> <span class="dv">9</span>)
y2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">138</span>, <span class="dt">sd =</span> <span class="dv">8</span>)
<span class="kw">plot</span>(x, y1,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Systolic Blood Pressure Before and After Treatment&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Systolic Blood Pressure (mmHg)&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Frequency&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">110</span>, <span class="dv">175</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)
)
<span class="kw">lines</span>(x, y2)
<span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">110</span>, x, <span class="dv">175</span>), <span class="kw">c</span>(<span class="dv">0</span>, y2, <span class="dv">0</span>),
  <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>,
  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>
)
<span class="kw">polygon</span>(<span class="kw">c</span>(<span class="dv">117</span>, x, <span class="dv">175</span>), <span class="kw">c</span>(<span class="dv">0</span>, y1, <span class="dv">0</span>),
  <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>,
  <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>
)
ylab &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">175</span>, <span class="dt">by =</span> <span class="dv">25</span>))
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="fl">0.05</span>, <span class="dt">length.out =</span> <span class="dv">8</span>))
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> y, <span class="dt">labels =</span> ylab, <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">120</span>, <span class="dt">y =</span> <span class="fl">0.045</span>, <span class="st">&quot;- Pre-Treatment BP&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>)
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">120</span>, <span class="dt">y =</span> <span class="fl">0.04</span>, <span class="st">&quot; - Post-Treatment BP&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>)
<span class="kw">points</span>(<span class="dv">109</span>, <span class="fl">0.0445</span>, <span class="dt">pch =</span> <span class="dv">15</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue4&quot;</span>)
<span class="kw">points</span>(<span class="dv">109</span>, <span class="fl">0.0395</span>, <span class="dt">pch =</span> <span class="dv">15</span>, <span class="dt">col =</span> <span class="st">&quot;firebrick3&quot;</span>)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-34-1.png" width="65%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">days &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dv">80</span>, <span class="dv">125</span>))
<span class="kw">plot</span>(<span class="kw">density</span>(days, <span class="dt">from =</span> <span class="dv">0</span>),
  <span class="dt">main =</span> <span class="st">&quot;Density plot&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Number of days since trial started&quot;</span>
)
<span class="kw">plot</span>(<span class="kw">density</span>(days, <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">180</span>, <span class="dt">adjust =</span> <span class="fl">0.2</span>),
  <span class="dt">main =</span> <span class="st">&quot;Density plot - Up to 180 days (86% of data)&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Number of days since trial started&quot;</span>
)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-35-1.png" width="55%" style="display: block; margin: auto;" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-35-2.png" width="55%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survival)
surv.days &lt;-<span class="st"> </span><span class="kw">Surv</span>(days)
surv.fit &lt;-<span class="st"> </span><span class="kw">survfit</span>(surv.days <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)
<span class="kw">plot</span>(surv.fit,
  <span class="dt">main =</span> <span class="st">&quot;Kaplan-Meier estimate with 95% confidence bounds (86% of data)&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Days since trial started&quot;</span>,
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">180</span>),
  <span class="dt">ylab =</span> <span class="st">&quot;Survival function&quot;</span>
)
<span class="kw">grid</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-36-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-ecdf" class="section level3">
<h3><span class="header-section-number">12.2.4</span> 经验图</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(<span class="dt">data =</span> faithful, {
  long &lt;-<span class="st"> </span>eruptions[eruptions <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>]
  <span class="kw">plot</span>(<span class="kw">ecdf</span>(long), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">verticals =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
  x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">3</span>, <span class="fl">5.4</span>, <span class="fl">0.01</span>)
  <span class="kw">lines</span>(x, <span class="kw">pnorm</span>(x, <span class="dt">mean =</span> <span class="kw">mean</span>(long), <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="kw">var</span>(long))), <span class="dt">lty =</span> <span class="dv">3</span>)
})</code></pre>
<div class="figure" style="text-align: center"><span id="fig:faithful"></span>
<img src="13-data-visualization-with-plot_files/figure-html/faithful-1.png" alt="累积经验分布图" width="70%" />
<p class="caption">
图 12.39: 累积经验分布图
</p>
</div>
</div>
<div id="plot-qqnorm" class="section level3">
<h3><span class="header-section-number">12.2.5</span> QQ 图</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(<span class="dt">data =</span> faithful, {
  long &lt;-<span class="st"> </span>eruptions[eruptions <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>]
  <span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>) <span class="co"># arrange for a square figure region</span>
  <span class="kw">qqnorm</span>(long, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
  <span class="kw">qqline</span>(long)
})</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/faithful-eruptions-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-ts" class="section level3">
<h3><span class="header-section-number">12.2.6</span> 时序图</h3>
<p>时序图最适合用来描述股价走势</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(<span class="kw">time</span>(EuStockMarkets), EuStockMarkets,
  <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Date&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;closing prices&quot;</span>,
  <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>
)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">colnames</span>(EuStockMarkets), <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-37"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-37-1.png" alt="1991–1998年间主要欧洲股票市场日闭市价格指数图 
 德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE" width="70%" />
<p class="caption">
图 12.40: 1991–1998年间主要欧洲股票市场日闭市价格指数图
德国 DAX (Ibis), Switzerland SMI, 法国 CAC 和 英国 FTSE
</p>
</div>
</div>
<div id="plot-pie" class="section level3">
<h3><span class="header-section-number">12.2.7</span> 饼图</h3>
<p>clockwise 参数</p>
<pre class="sourceCode r"><code class="sourceCode r">pie.sales &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.12</span>, <span class="fl">0.3</span>, <span class="fl">0.26</span>, <span class="fl">0.16</span>, <span class="fl">0.04</span>, <span class="fl">0.12</span>)
<span class="kw">names</span>(pie.sales) &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">&quot;Blueberry&quot;</span>, <span class="st">&quot;Cherry&quot;</span>,
  <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Boston Cream&quot;</span>, <span class="st">&quot;Other&quot;</span>, <span class="st">&quot;Vanilla Cream&quot;</span>
)
<span class="kw">pie</span>(pie.sales, <span class="dt">clockwise =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="st">&quot;init.angle = 90&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-38-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-stem-leaf" class="section level3">
<h3><span class="header-section-number">12.2.8</span> 茎叶图</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stem</span>(longley<span class="op">$</span>Unemployed)
<span class="co">#&gt; </span>
<span class="co">#&gt;   The decimal point is 2 digit(s) to the right of the |</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   1 | 99</span>
<span class="co">#&gt;   2 | 134899</span>
<span class="co">#&gt;   3 | 46789</span>
<span class="co">#&gt;   4 | 078</span></code></pre>
</div>
<div id="plot-scatter" class="section level3">
<h3><span class="header-section-number">12.2.9</span> 散点图</h3>
<p>在一维空间上，绘制散点图，其实是在看散点的疏密程度随坐标轴的变化</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stripchart</span>(longley<span class="op">$</span>Unemployed, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">jitter =</span> <span class="fl">0.1</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)
<span class="kw">stripchart</span>(longley<span class="op">$</span>Unemployed, <span class="dt">method =</span> <span class="st">&quot;overplot&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-40"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-40-1.png" alt="一维散点图" width="70%" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-40-2.png" alt="一维散点图" width="70%" />
<p class="caption">
图 12.41: 一维散点图
</p>
</div>
<p>气泡图是二维散点图的一种变体，气泡的大小可以用来描述第三个变量，下面以数据集 topo 为例展示气泡图</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 加载数据集</span>
<span class="kw">data</span>(topo, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)
<span class="co"># 查看数据集</span>
<span class="kw">str</span>(topo)
<span class="co">#&gt; &#39;data.frame&#39;:    52 obs. of  3 variables:</span>
<span class="co">#&gt;  $ x: num  0.3 1.4 2.4 3.6 5.7 1.6 2.9 3.4 3.4 4.8 ...</span>
<span class="co">#&gt;  $ y: num  6.1 6.2 6.1 6.2 6.2 5.2 5.1 5.3 5.7 5.6 ...</span>
<span class="co">#&gt;  $ z: int  870 793 755 690 800 800 730 728 710 780 ...</span></code></pre>
<p>topo 是空间地形数据集，包含有52行3列，数据点是310平方英尺范围内的海拔高度数据，x 坐标每单位50英尺，y 坐标单位同 x 坐标，海拔高度 z 单位是英尺</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x,
  <span class="dt">cex =</span> (<span class="dv">960</span> <span class="op">-</span><span class="st"> </span>z) <span class="op">/</span><span class="st"> </span>(<span class="dv">960</span> <span class="op">-</span><span class="st"> </span><span class="dv">690</span>) <span class="op">*</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">data =</span> topo,
  <span class="dt">xlab =</span> <span class="st">&quot;X Coordinates&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Y coordinates&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-42"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-42-1.png" alt="地形图之海拔高度" width="70%" />
<p class="caption">
图 12.42: 地形图之海拔高度
</p>
</div>
<p>散点图也适合分类数据的展示，在图中用不同颜色或符号标记数据点所属类别，即在普通散点图的基础上添加一分类变量的描述</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mpg <span class="op">~</span><span class="st"> </span>hp,
  <span class="dt">data =</span> <span class="kw">subset</span>(mtcars, am <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,
  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">350</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">35</span>)
)
<span class="kw">points</span>(mpg <span class="op">~</span><span class="st"> </span>hp,
  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>,
  <span class="dt">data =</span> <span class="kw">subset</span>(mtcars, am <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
)
<span class="kw">legend</span>(<span class="dv">300</span>, <span class="dv">35</span>,
  <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>),
  <span class="dt">title =</span> <span class="st">&quot;am&quot;</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),
  <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">16</span>)
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:category-base"></span>
<img src="13-data-visualization-with-plot_files/figure-html/category-base-1.png" alt="分类散点图" width="70%" />
<p class="caption">
图 12.43: 分类散点图
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> iris, <span class="dt">col =</span> Species, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,
  <span class="dt">legend =</span> <span class="kw">unique</span>(iris<span class="op">$</span>Species), <span class="dt">box.col =</span> <span class="st">&quot;gray&quot;</span>,
  <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">unique</span>(iris<span class="op">$</span>Species)
)
<span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-43"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-43-1.png" alt="分类散点图" width="70%" />
<p class="caption">
图 12.44: 分类散点图
</p>
</div>
<p>分组散点图和平滑</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
<span class="kw">scatterplot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">16</span>,<span class="dv">16</span>),
            <span class="dt">smooth =</span> <span class="ot">TRUE</span>, <span class="dt">boxplots =</span> <span class="st">&quot;xy&quot;</span>, <span class="dt">groups =</span> iris<span class="op">$</span>Species, 
            <span class="dt">xlab =</span> <span class="st">&quot;Sepal.Width&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Sepal.Length&quot;</span>, <span class="dt">data =</span> iris
)</code></pre>
<p>有时为了实现特定的目的，需要高亮其中某些点，按类别或者因子变量分组绘制散点图，这里继续采用 <code>stripchart</code> 函数绘制二维散点图<a href="13-data-visualization-with-plot.html#fig:scatter-iris">12.45</a>， 由左图可知，函数 <code>stripchart</code> 提供的参数 <code>pch</code> 不接受向量，实际只是取了前三个值 16 16 17 对应于 Species 的三类，关键是高亮的分界点是有区分意义的</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)
pch &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">16</span>, <span class="kw">length</span>(iris<span class="op">$</span>Petal.Length))
pch[<span class="kw">which</span>(iris<span class="op">$</span>Petal.Length <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.4</span>)] &lt;-<span class="st"> </span><span class="dv">17</span>
<span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,
  <span class="dt">data =</span> iris,
  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>,
  <span class="dt">pch =</span> pch
)
<span class="co"># 对比一下</span>
<span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,
  <span class="dt">data =</span> iris, <span class="dt">subset =</span> Petal.Length <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.4</span>,
  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>),
  <span class="dt">pch =</span> <span class="dv">16</span>
)
<span class="kw">stripchart</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species,
  <span class="dt">data =</span> iris, <span class="dt">subset =</span> Petal.Length <span class="op">&lt;</span><span class="st"> </span><span class="fl">1.4</span>,
  <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,
  <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:scatter-iris"></span>
<img src="13-data-visualization-with-plot_files/figure-html/scatter-iris-1.png" alt="高亮图中部分散点" width="35%" /><img src="13-data-visualization-with-plot_files/figure-html/scatter-iris-2.png" alt="高亮图中部分散点" width="35%" />
<p class="caption">
图 12.45: 高亮图中部分散点
</p>
</div>
<p>如果存在大量散点</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">densCols</span>(x, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">nbin =</span> <span class="dv">128</span>, bandwidth,
         <span class="dt">colramp =</span> <span class="kw">colorRampPalette</span>(blues9[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)]))</code></pre>
<p><code>densCols</code> 函数根据点的局部密度生成颜色，密度估计采用核平滑法，由 <strong>KernSmooth</strong> 包的 <code>bkde2D</code> 函数实现。参数 <code>colramp</code> 传递一个函数，<code>colorRampPalette</code> 根据给定的几种颜色生成函数，参数 <code>bandwidth</code> 实际上是传给 <code>bkde2D</code> 函数</p>
<pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="fl">1e3</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
x2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="fl">1e3</span>, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="fl">1.5</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)
x &lt;-<span class="st"> </span><span class="kw">rbind</span>(x1, x2)
dcols &lt;-<span class="st"> </span><span class="kw">densCols</span>(x)
graphics<span class="op">::</span><span class="kw">plot</span>(x, <span class="dt">col =</span> dcols, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>())
<span class="co"># title(main = &quot;n = 1000&quot;, xpd = TRUE)</span></code></pre>
<div class="figure" style="text-align: center"><span id="fig:densCols"></span>
<img src="13-data-visualization-with-plot_files/figure-html/densCols-1.png" alt="根据点的密度生成颜色" width="45%" />
<p class="caption">
图 12.46: 根据点的密度生成颜色
</p>
</div>
<p>气泡图也是散点图的一种</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Volume <span class="op">~</span><span class="st"> </span>Height,
  <span class="dt">data =</span> trees, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> Girth <span class="op">/</span><span class="st"> </span><span class="dv">8</span>,
  <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">terrain.colors</span>(<span class="kw">nrow</span>(trees), <span class="dt">alpha =</span> <span class="fl">.5</span>))
)
<span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-46"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-46-1.png" alt="气泡图" width="70%" />
<p class="caption">
图 12.47: 气泡图
</p>
</div>
</div>
<div id="base-jitter" class="section level3">
<h3><span class="header-section-number">12.2.10</span> 抖动图</h3>
<p>抖动散点图</p>
<pre class="sourceCode r"><code class="sourceCode r">mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">colors</span>()), <span class="dt">ncol =</span> <span class="dv">9</span>, <span class="dt">byrow=</span> <span class="ot">TRUE</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col =</span> <span class="kw">colors</span>(), 
    <span class="dt">x =</span> <span class="kw">as.integer</span>(<span class="kw">cut</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">colors</span>()), <span class="dv">9</span>)),
    <span class="dt">y =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">73</span>, <span class="dv">9</span>), <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">jitter</span>(x), <span class="dt">data =</span> df, <span class="dt">col =</span> df<span class="op">$</span>col,
    <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">main =</span> <span class="st">&quot;Visualizing colors() split in 9 groups&quot;</span>,
    <span class="dt">xlab =</span> <span class="st">&quot;Group&quot;</span>, 
    <span class="dt">ylab =</span> <span class="st">&quot;Element of the group (min = 1, max = 73)&quot;</span>,
    <span class="dt">sub =</span> <span class="st">&quot;x = 3, y = 1 means that it&#39;s the 2 * 73 + 1 = 147th color&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:jitter-scatter"></span>
<img src="13-data-visualization-with-plot_files/figure-html/jitter-scatter-1.png" alt="抖动散点图" width="70%" />
<p class="caption">
图 12.48: 抖动散点图
</p>
</div>
</div>
<div id="plot-box" class="section level3">
<h3><span class="header-section-number">12.2.11</span> 箱线图</h3>
<p>boxplotdbl: Double Box Plot for Two-Axes Correlation</p>
<p>Correlation chart of two set (x and y) of data. Using Quartiles with boxplot style. Visualize the effect of factor.</p>
<p>复合箱线图</p>
<p><a href="https://tomizonor.wordpress.com/2013/11/24/double-box-plot-1-2/" class="uri">https://tomizonor.wordpress.com/2013/11/24/double-box-plot-1-2/</a>
<a href="https://tomizonor.wordpress.com/2013/03/15/double-box-plot/" class="uri">https://tomizonor.wordpress.com/2013/03/15/double-box-plot/</a></p>
<pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="fl">79.98</span>, <span class="fl">80.04</span>, <span class="fl">80.02</span>, <span class="fl">80.04</span>, <span class="fl">80.03</span>, <span class="fl">80.03</span>, <span class="fl">80.04</span>, <span class="fl">79.97</span>,
  <span class="fl">80.05</span>, <span class="fl">80.03</span>, <span class="fl">80.02</span>, <span class="dv">80</span>, <span class="fl">80.02</span>
)
B &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">80.02</span>, <span class="fl">79.94</span>, <span class="fl">79.98</span>, <span class="fl">79.97</span>, <span class="fl">79.97</span>, <span class="fl">80.03</span>, <span class="fl">79.95</span>, <span class="fl">79.97</span>)
<span class="kw">boxplot</span>(A, B)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/boxplot-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(<span class="dt">data =</span> iris, {
  op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="fl">.5</span>))
  <span class="kw">plot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species)
  <span class="kw">plot</span>(Sepal.Width <span class="op">~</span><span class="st"> </span>Species)
  <span class="kw">plot</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species)
  <span class="kw">plot</span>(Petal.Width <span class="op">~</span><span class="st"> </span>Species)
  <span class="kw">par</span>(op)
  <span class="kw">mtext</span>(<span class="st">&quot;Edgar Anderson&#39;s Iris Data&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">4</span>)
})</code></pre>
<div class="figure" style="text-align: center"><span id="fig:iris"></span>
<img src="13-data-visualization-with-plot_files/figure-html/iris-1.png" alt="安德森的鸢尾花数据" width="70%" />
<p class="caption">
图 12.49: 安德森的鸢尾花数据
</p>
</div>
<p>箱线图的花样也很多</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(longley<span class="op">$</span>Unemployed)
<span class="co"># 水平放置</span>
<span class="kw">boxplot</span>(longley<span class="op">$</span>Unemployed,
  <span class="dt">horizontal =</span> <span class="ot">TRUE</span>,
  <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;&quot;</span>
)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;" /><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-47-2.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(InsectSprays)
<span class="kw">boxplot</span>(count <span class="op">~</span><span class="st"> </span>spray,
  <span class="dt">data =</span> InsectSprays,
  <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Spray&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Count&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;&quot;</span>
)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>水平放置</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(count <span class="op">~</span><span class="st"> </span>spray,
  <span class="dt">data =</span> InsectSprays,
  <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>,
  <span class="dt">horizontal =</span> <span class="ot">TRUE</span>,
  <span class="dt">las =</span> <span class="dv">1</span>, <span class="co"># Horizontal labels</span>
  <span class="dt">xlab =</span> <span class="st">&quot;Count&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Spray&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;&quot;</span>
)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="error-bars" class="section level3">
<h3><span class="header-section-number">12.2.12</span> 残差图</h3>
<p>iris 四个测量指标</p>
<pre class="sourceCode r"><code class="sourceCode r">vec_mean &lt;-<span class="st"> </span><span class="kw">colMeans</span>(iris[,<span class="op">-</span><span class="dv">5</span>])
vec_sd &lt;-<span class="st"> </span><span class="kw">apply</span>(iris[, <span class="dv">-5</span>], <span class="dv">2</span>, sd)
<span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">4</span>), vec_mean,
  <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(vec_mean <span class="op">-</span><span class="st"> </span>vec_sd, vec_mean <span class="op">+</span><span class="st"> </span>vec_sd)),
  <span class="dt">xlab =</span> <span class="st">&quot;Species&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Mean +/- SD&quot;</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">19</span>,
  <span class="dt">axes =</span> <span class="ot">FALSE</span>
)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">4</span>), <span class="dt">labels =</span> <span class="kw">colnames</span>(iris)[<span class="op">-</span><span class="dv">5</span>])
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">7</span>), <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dv">7</span>))
<span class="kw">arrows</span>(<span class="kw">seq</span>(<span class="dv">4</span>), vec_mean <span class="op">-</span><span class="st"> </span>vec_sd, <span class="kw">seq</span>(<span class="dv">4</span>), vec_mean <span class="op">+</span><span class="st"> </span>vec_sd,
  <span class="dt">length =</span> <span class="fl">0.05</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">code =</span> <span class="dv">3</span>
)
<span class="kw">box</span>()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-50"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-50-1.png" alt="带标准差的均值散点图" width="70%" />
<p class="caption">
图 12.50: 带标准差的均值散点图
</p>
</div>
</div>
<div id="plot-violin" class="section level3">
<h3><span class="header-section-number">12.2.13</span> 提琴图</h3>
<p>Tom Kelly 维护的 vioplot 包 <a href="https://github.com/TomKellyGenetics/vioplot" class="uri">https://github.com/TomKellyGenetics/vioplot</a></p>
</div>
<div id="plot-contour" class="section level3">
<h3><span class="header-section-number">12.2.14</span> 轮廓图</h3>
<p>topo 是地形数据</p>
<p>等高线图</p>
</div>
<div id="plot-line" class="section level3">
<h3><span class="header-section-number">12.2.15</span> 折线图</h3>
<p>函数曲线，样条曲线，核密度曲线，平行坐标图</p>
<ul>
<li>折线图
<ul>
<li>点线图 <code>plot(type="b")</code> 函数曲线图 <code>curve</code> <code>matplot</code> X 样条曲线 <code>xspline</code></li>
<li>时序图</li>
</ul></li>
</ul>
<p>太阳黑子活动数据</p>
<p>sunspot.month Monthly Sunspot Data, from 1749 to “Present”
sunspot.year Yearly Sunspot Data, 1700-1988
sunspots Monthly Sunspot Numbers, 1749-1983</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(AirPassengers)
<span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-51"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-51-1.png" alt="折线图" width="70%" />
<p class="caption">
图 12.51: 折线图
</p>
</div>
</div>
<div id="function" class="section level3">
<h3><span class="header-section-number">12.2.16</span> 函数图</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pracma)
<span class="co">##  First zero on the critical line s = 0.5 + i t</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dt">len =</span> <span class="dv">1001</span>)
z &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>1i
fr &lt;-<span class="st"> </span><span class="kw">Re</span>(<span class="kw">zeta</span>(z))
fi &lt;-<span class="st"> </span><span class="kw">Im</span>(<span class="kw">zeta</span>(z))
fa &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">zeta</span>(z))
<span class="kw">plot</span>(x, fa,
  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">2.5</span>),
  <span class="dt">xlab =</span> <span class="st">&quot;Imaginary part (on critical line)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Function value&quot;</span>,
  <span class="dt">main =</span> <span class="st">&quot;Riemann&#39;s Zeta Function along the critical line&quot;</span>
)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x, fr, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">lines</span>(x, fi, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)
<span class="kw">lines</span>(x, fa, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">points</span>(<span class="fl">14.1347</span>, <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>)
<span class="kw">legend</span>(<span class="dv">0</span>, <span class="fl">2.4</span>, <span class="kw">c</span>(<span class="st">&quot;real part&quot;</span>, <span class="st">&quot;imaginary part&quot;</span>, <span class="st">&quot;absolute value&quot;</span>),
  <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;red&quot;</span>)
)</code></pre>
<p><img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-52-1.png" width="65%" style="display: block; margin: auto;" /></p>
<p>还有 eta 函数和 gammaz 函数</p>
</div>
<div id="plot-mosaic" class="section level3">
<h3><span class="header-section-number">12.2.17</span> 马赛克图</h3>
<p>马赛克图 mosaicplot</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(HairEyeColor, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-53"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-53-1.png" alt="马赛克图" width="70%" />
<p class="caption">
图 12.52: 马赛克图
</p>
</div>
</div>
<div id="dotchart" class="section level3">
<h3><span class="header-section-number">12.2.18</span> 克利夫兰点图</h3>
<p>dotchart</p>
<p>条件图 coplot</p>
</div>
<div id="plot-matrix" class="section level3">
<h3><span class="header-section-number">12.2.19</span> 矩阵图</h3>
<p>在对角线上添加平滑曲线、密度曲线</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(longley,
  <span class="dt">gap =</span> <span class="dv">0</span>,
  <span class="dt">diag.panel =</span> <span class="cf">function</span>(x, ...) {
    <span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)
    <span class="kw">hist</span>(x,
      <span class="dt">col =</span> <span class="st">&quot;light blue&quot;</span>,
      <span class="dt">probability =</span> <span class="ot">TRUE</span>,
      <span class="dt">axes =</span> <span class="ot">FALSE</span>,
      <span class="dt">main =</span> <span class="st">&quot;&quot;</span>
    )
    <span class="kw">lines</span>(<span class="kw">density</span>(x),
      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,
      <span class="dt">lwd =</span> <span class="dv">3</span>
    )
    <span class="kw">rug</span>(x)
  }
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-54"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-54-1.png" alt="变量关系" width="70%" />
<p class="caption">
图 12.53: 变量关系
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 自带 layout</span>
<span class="kw">plot</span>(iris[, <span class="dv">-5</span>], <span class="dt">col =</span> iris<span class="op">$</span>Species)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-55"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-55-1.png" alt="矩阵图" width="70%" />
<p class="caption">
图 12.54: 矩阵图
</p>
</div>
</div>
<div id="plot-radar" class="section level3">
<h3><span class="header-section-number">12.2.20</span> 雷达图</h3>
<p>星图 stars 多元数据</p>
</div>
<div id="plot-rose" class="section level3">
<h3><span class="header-section-number">12.2.21</span> 玫瑰图</h3>
</div>
<div id="plot-map" class="section level3">
<h3><span class="header-section-number">12.2.22</span> 地形图</h3>
<ul>
<li>轮廓图 contour 等高线图</li>
<li>热图 image</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 代码来自 ?map</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))
<span class="kw">library</span>(mapproj)
<span class="kw">data</span>(unemp)
<span class="kw">data</span>(county.fips)
colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#F1EEF6&quot;</span>, <span class="st">&quot;#D4B9DA&quot;</span>, <span class="st">&quot;#C994C7&quot;</span>, <span class="st">&quot;#DF65B0&quot;</span>, <span class="st">&quot;#DD1C77&quot;</span>, <span class="st">&quot;#980043&quot;</span>)
unemp<span class="op">$</span>colorBuckets &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">cut</span>(unemp<span class="op">$</span>unemp, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">100</span>)))
leg.txt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&lt;2%&quot;</span>, <span class="st">&quot;2-4%&quot;</span>, <span class="st">&quot;4-6%&quot;</span>, <span class="st">&quot;6-8%&quot;</span>, <span class="st">&quot;8-10%&quot;</span>, <span class="st">&quot;&gt;10%&quot;</span>)
cnty.fips &lt;-<span class="st"> </span>county.fips<span class="op">$</span>fips[<span class="kw">match</span>(
  <span class="kw">map</span>(<span class="st">&quot;county&quot;</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)<span class="op">$</span>names,
  county.fips<span class="op">$</span>polyname
)]
colorsmatched &lt;-<span class="st"> </span>unemp<span class="op">$</span>colorBuckets [<span class="kw">match</span>(cnty.fips, unemp<span class="op">$</span>fips)]
<span class="co"># draw map</span>
<span class="kw">map</span>(<span class="st">&quot;county&quot;</span>,
  <span class="dt">col =</span> colors[colorsmatched], <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">resolution =</span> <span class="dv">0</span>,
  <span class="dt">lty =</span> <span class="dv">0</span>, <span class="dt">projection =</span> <span class="st">&quot;polyconic&quot;</span>
)
<span class="kw">map</span>(<span class="st">&quot;state&quot;</span>,
  <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="ot">FALSE</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="fl">0.2</span>,
  <span class="dt">projection =</span> <span class="st">&quot;polyconic&quot;</span>
)
<span class="kw">title</span>(<span class="st">&quot;unemployment by county, 2009&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, leg.txt,
  <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">fill =</span> colors,
  <span class="dt">border =</span> <span class="st">&quot;gray&quot;</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unemployment"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unemployment-1.png" alt="2009年美国各城镇失业率" width="70%" />
<p class="caption">
图 12.55: 2009年美国各城镇失业率
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="st">&quot;spDataLarge&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">.packages</span>(<span class="ot">TRUE</span>)) {
  <span class="kw">install.packages</span>(<span class="st">&quot;spDataLarge&quot;</span>,
    <span class="dt">repos =</span> <span class="st">&quot;https://nowosad.github.io/drat/&quot;</span>,
    <span class="dt">type =</span> <span class="st">&quot;source&quot;</span>
  )
}</code></pre>
<p>raster 图形，Elevation raster data from SRTM of the Zion National Park area</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sp)
<span class="kw">library</span>(raster)
<span class="kw">library</span>(spDataLarge)
<span class="kw">plot</span>(elevation, <span class="dt">asp =</span> <span class="ot">NA</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-57"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-57-1.png" alt="raster 图形" width="70%" />
<p class="caption">
图 12.56: raster 图形
</p>
</div>
<p>注意与 image 函数区别</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A prettier display of the volcano</span>
x &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(volcano))
y &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(volcano))
<span class="kw">image</span>(x, y, volcano, <span class="dt">col =</span> <span class="kw">terrain.colors</span>(<span class="dv">100</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>)
<span class="kw">contour</span>(x, y, volcano, <span class="dt">levels =</span> <span class="kw">seq</span>(<span class="dv">90</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">5</span>),
        <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;peru&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">800</span>, <span class="dt">by =</span> <span class="dv">100</span>))
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">600</span>, <span class="dt">by =</span> <span class="dv">100</span>))
<span class="kw">box</span>()
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Maunga Whau Volcano&quot;</span>, <span class="dt">font.main =</span> <span class="dv">4</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-58"></span>
<img src="13-data-visualization-with-plot_files/figure-html/unnamed-chunk-58-1.png" alt="image 图形" width="70%" />
<p class="caption">
图 12.57: image 图形
</p>
</div>
</div>
</div>
<div id="tikz" class="section level2">
<h2><span class="header-section-number">12.3</span> TikZ 绘图</h2>
<blockquote>
<p>用 Base R 绘制带有复杂数学公式的图形，tikzDevice 包结合 R Markdown 的使用，引入 LaTeX 绘图引擎 TikZ 主要是借助 LaTeX 对数学符号的强大支持，让R 语言绘制的图形上出现优美的复杂的数学符号表达式</p>
</blockquote>
<p>以 tikzDevice 绘图， <code>out.width='35%'</code> 设置一幅子图占页面的宽度，在 <code>_common.R</code> 设置页面宽度为 <code>out.width='70%'</code>，即全宽图占页面 70% 的宽度。 <code>fig.asp=1</code> 设置子图的长宽比例为 1:1，即正方形。设置图片的宽度，默认是 <code>fig.width = 6</code> 相应地，图片的高度是 <code>fig.height = fig.width * fig.asp = 6 * 0.618 = 3.708</code> 但是这个比例使得图片上的字很小，所以设置<code>fig.width=2.5</code>。设置图形设备 <code>dev='tikz'</code>，此时会自动调用 tikzDevice 包处理图上的数学公式，tikzDevice 包将 LaTeX 中的 TikZ 绘图引擎引入到基础 R 绘图中，由于该引擎将R代码块转化为 <code>.tex</code> 文件，接着调用 LaTeX 编译，默认生成 PDF 格式图片，因此设置 <code>tikz2png='-density 300'</code> 调用 ImageMgick 的 <code>convert</code> 命令将 PDF 格式图片转化为 PNG 格式图片，转化前需要用 Ghostscript 读取该 PDF 文件，转化成功后，需要将该 PNG 格式文件路径返回，以插入到文档中。<code>bessel-function</code> 是给该图片的命名，这段代码生成两张图片，两个图片就分别叫做 <code>bessel-function-1.pdf</code> 和 <code>bessel-function-2.pdf</code>。在 LaTeX 里并排插入两个图片，需要在导言区加载 <code>subfig</code> 宏包。</p>
<p>knitr 提供 Tikz 图形的模版， <code>system.file('misc', 'tikz2pdf.tex', package = 'knitr')</code>，<strong>tikzDevice</strong> 包可以方便的把 R 代码转化为 tikz 代码，然后使用 LaTeX 引擎编译成 PDF 文档，特别地，它很好地支持了图里的数学公式</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tikzDevice)
tf &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">getwd</span>(), <span class="st">&quot;demo-tikzDevice.tex&quot;</span>)

<span class="kw">tikz</span>(tf, <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">pointsize =</span> <span class="dv">30</span>, <span class="dt">standAlone =</span> <span class="ot">TRUE</span>)
<span class="co"># 绘图的代码，仅支持 Base R Graphics System</span>
<span class="kw">source</span>(<span class="dt">file =</span> <span class="st">&quot;code/chapter_03/matern.R&quot;</span>)
<span class="kw">dev.off</span>()

tools<span class="op">::</span><span class="kw">texi2dvi</span>(tf, <span class="dt">pdf =</span> T)

<span class="kw">system</span>(<span class="st">&quot;rm demo-tikzDevice.tex *.log *.aux *.dvi&quot;</span>)

<span class="kw">system</span>(<span class="st">&quot;convert -density 300 -trim demo-tikzDevice.pdf -quality 100 demo-tikzDevice.png&quot;</span>)

<span class="kw">system</span>(<span class="st">&quot;mv demo-tikzDevice.* figures/&quot;</span>)
<span class="co"># convert test.svg test.png</span></code></pre>
<p>如图所示</p>
<p>两个利用 tikzDevice 包的例子</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 带有图标题</span>
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)
y &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">5</span>, <span class="dt">sd =</span> <span class="fl">0.25</span>)
model &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
rsq &lt;-<span class="st"> </span><span class="kw">summary</span>(model)<span class="op">$</span>r.squared
rsq &lt;-<span class="st"> </span><span class="kw">signif</span>(rsq, <span class="dv">4</span>)
<span class="kw">plot</span>(x, y, <span class="dt">main =</span> <span class="st">&quot;Hello </span><span class="ch">\\</span><span class="st">LaTeX!&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;$x$&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;$y$&quot;</span>)
<span class="kw">abline</span>(model, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">mtext</span>(<span class="kw">paste</span>(<span class="st">&quot;Linear model: $R^{2}=&quot;</span>, rsq, <span class="st">&quot;$&quot;</span>), <span class="dt">line =</span> <span class="fl">0.5</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">paste</span>(<span class="st">&quot;$y = &quot;</span>, <span class="kw">round</span>(<span class="kw">coef</span>(model)[<span class="dv">2</span>], <span class="dv">3</span>),
  <span class="st">&quot;x +&quot;</span>, <span class="kw">round</span>(<span class="kw">coef</span>(model)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;$&quot;</span>,
  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>
), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)

<span class="kw">plot</span>(x, y, <span class="dt">main =</span> <span class="st">&quot;Hello </span><span class="ch">\\</span><span class="st">LaTeX!&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;$x$&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;$y$&quot;</span>)
<span class="kw">abline</span>(model, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">mtext</span>(<span class="kw">paste</span>(<span class="st">&quot;Linear model: $R^{2}=&quot;</span>, rsq, <span class="st">&quot;$&quot;</span>), <span class="dt">line =</span> <span class="fl">0.5</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">paste</span>(<span class="st">&quot;$y = &quot;</span>, <span class="kw">round</span>(<span class="kw">coef</span>(model)[<span class="dv">2</span>], <span class="dv">3</span>),
  <span class="st">&quot;x +&quot;</span>, <span class="kw">round</span>(<span class="kw">coef</span>(model)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;$&quot;</span>,
  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>
), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:linear-model"></span>
<img src="13-data-visualization-with-plot_files/figure-html/linear-model-1.png" alt="线性回归模型" width="35%" /><img src="13-data-visualization-with-plot_files/figure-html/linear-model-2.png" alt="线性回归模型" width="35%" />
<p class="caption">
图 12.58: 线性回归模型
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r">x0 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">20</span><span class="op">:</span><span class="dv">10</span>)
nus &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">length.out =</span> <span class="dv">501</span>)

<span class="kw">plot</span>(x0, x0<span class="op">^-</span><span class="dv">8</span>,
  <span class="dt">frame.plot =</span> <span class="ot">TRUE</span>, <span class="co"># 添加绘图框</span>
  <span class="dt">log =</span> <span class="st">&quot;xy&quot;</span>, <span class="co"># x 和 y 轴都取对数尺度</span>
  <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="co"># 去掉坐标轴</span>
  <span class="dt">xlab =</span> <span class="st">&quot;$u$&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;$</span><span class="ch">\\</span><span class="st">mathcal{K}_{</span><span class="ch">\\</span><span class="st">kappa}(u)$&quot;</span>, <span class="co"># 设置坐标轴标签</span>
  <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="co"># 清除绘图区域的内容</span>
  <span class="dt">ann =</span> <span class="ot">TRUE</span>, <span class="co"># 添加标题 x和y轴标签</span>
  <span class="dt">panel.first =</span> <span class="kw">grid</span>() <span class="co"># 添加背景参考线</span>
)

<span class="kw">axis</span>(<span class="dv">1</span>,
  <span class="dt">at =</span> <span class="dv">10</span><span class="op">^</span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">by =</span> <span class="dv">2</span>),
  <span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">mathsf{10^{&quot;</span>, <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">by =</span> <span class="dv">2</span>), <span class="st">&quot;}}$&quot;</span>)
)
<span class="kw">axis</span>(<span class="dv">2</span>,
  <span class="dt">at =</span> <span class="dv">10</span><span class="op">^</span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">56</span>, <span class="dt">by =</span> <span class="dv">16</span>),
  <span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">mathsf{10^{&quot;</span>, <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">56</span>, <span class="dt">by =</span> <span class="dv">16</span>), <span class="st">&quot;}}$&quot;</span>), <span class="dt">las =</span> <span class="dv">1</span>
)

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="kw">length</span>(nus))) {
  <span class="kw">lines</span>(x0, <span class="kw">besselK</span>(x0, <span class="dt">nu =</span> nus[i]), <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">9</span>)[i], <span class="dt">lwd =</span> <span class="dv">2</span>)
}
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,
  <span class="dt">legend =</span> <span class="kw">paste0</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">kappa=&quot;</span>, <span class="kw">rev</span>(nus), <span class="st">&quot;$&quot;</span>),
  <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">9</span>, <span class="dt">rev =</span> T), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">1</span>
)

x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">length.out =</span> <span class="dv">501</span>)
x &lt;-<span class="st"> </span>x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]
<span class="kw">plot</span>(x, x,
  <span class="dt">frame.plot =</span> <span class="ot">TRUE</span>,
  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1e+0</span>, <span class="fl">1e+20</span>), <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;$u$&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;$</span><span class="ch">\\</span><span class="st">mathcal{K}_{</span><span class="ch">\\</span><span class="st">kappa}(u)$&quot;</span>, <span class="dt">ann =</span> <span class="ot">TRUE</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>()
)
<span class="kw">axis</span>(<span class="dv">2</span>,
  <span class="dt">at =</span> <span class="kw">c</span>(<span class="fl">1e+0</span>, <span class="fl">1e+05</span>, <span class="fl">1e+10</span>, <span class="fl">1e+15</span>, <span class="fl">1e+20</span>),
  <span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">mathsf{10^{&quot;</span>, <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">5</span>), <span class="st">&quot;}}$&quot;</span>), <span class="dt">las =</span> <span class="dv">1</span>
)

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="kw">length</span>(nus))) {
  <span class="kw">lines</span>(x, <span class="kw">besselK</span>(x, <span class="dt">nu =</span> nus[i]), <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">9</span>)[i], <span class="dt">lwd =</span> <span class="dv">2</span>)
}
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,
  <span class="dt">legend =</span> <span class="kw">paste0</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">kappa=&quot;</span>, <span class="kw">rev</span>(nus), <span class="st">&quot;$&quot;</span>),
  <span class="dt">col =</span> <span class="kw">hcl.colors</span>(<span class="dv">9</span>, <span class="dt">rev =</span> T), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">1</span>
)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:bessel"></span>
<img src="13-data-visualization-with-plot_files/figure-html/bessel-1.png" alt="贝塞尔函数" width="35%" /><img src="13-data-visualization-with-plot_files/figure-html/bessel-2.png" alt="贝塞尔函数" width="35%" />
<p class="caption">
图 12.59: 贝塞尔函数
</p>
</div>
<p>如图 <a href="13-data-visualization-with-plot.html#fig:tikz-ex">12.60</a> 所示</p>
<pre class="sourceCode tex"><code class="sourceCode latex"><span class="fu">\usetikzlibrary</span>{arrows}
<span class="kw">\begin</span>{<span class="ex">tikzpicture</span>}[node distance=2cm, auto,&gt;=latex&#39;, thick, scale = 0.5]
<span class="fu">\node</span> (P) {<span class="ss">$P$</span>};
<span class="fu">\node</span> (B) [right of=P] {<span class="ss">$B$</span>};
<span class="fu">\node</span> (A) [below of=P] {<span class="ss">$A$</span>};
<span class="fu">\node</span> (C) [below of=B] {<span class="ss">$C$</span>};
<span class="fu">\node</span> (P1) [node distance=1.4cm, left of=P, above of=P] {<span class="ss">$</span><span class="sc">\hat</span><span class="ss">{P}$</span>};
<span class="fu">\draw</span>[-&gt;] (P) to node {<span class="ss">$f$</span>} (B);
<span class="fu">\draw</span>[-&gt;] (P) to node [swap] {<span class="ss">$g$</span>} (A);
<span class="fu">\draw</span>[-&gt;] (A) to node [swap] {<span class="ss">$f$</span>} (C);
<span class="fu">\draw</span>[-&gt;] (B) to node {<span class="ss">$g$</span>} (C);
<span class="fu">\draw</span>[-&gt;, bend right] (P1) to node [swap] {<span class="ss">$</span><span class="sc">\hat</span><span class="ss">{g}$</span>} (A);
<span class="fu">\draw</span>[-&gt;, bend left] (P1) to node {<span class="ss">$</span><span class="sc">\hat</span><span class="ss">{f}$</span>} (B);
<span class="fu">\draw</span>[-&gt;, dashed] (P1) to node {<span class="ss">$k$</span>} (P);
<span class="kw">\end</span>{<span class="ex">tikzpicture</span>}</code></pre>
<div class="figure" style="text-align: center"><span id="fig:tikz-ex"></span>
<img src="13-data-visualization-with-plot_files/figure-html/tikz-ex-1.png" alt="Funky tikz" width="40%" />
<p class="caption">
图 12.60: Funky tikz
</p>
</div>
<pre class="sourceCode tex"><code class="sourceCode latex"><span class="kw">\begin</span>{<span class="ex">tikzpicture</span>}
  <span class="kw">\begin</span>{<span class="ex">scope</span>}[blend group = soft light]
    <span class="fu">\fill</span>[red!30!white]   ( 90:1.2) circle (2);
    <span class="fu">\fill</span>[green!30!white] (210:1.2) circle (2);
    <span class="fu">\fill</span>[blue!30!white]  (330:1.2) circle (2);
  <span class="kw">\end</span>{<span class="ex">scope</span>}
  <span class="fu">\node</span> at ( 90:2)    {Typography};
  <span class="fu">\node</span> at ( 210:2)   {Design};
  <span class="fu">\node</span> at ( 330:2)   {Coding};
  <span class="fu">\node</span> [font=<span class="fu">\Large</span>] {<span class="fu">\LaTeX</span>};
<span class="kw">\end</span>{<span class="ex">tikzpicture</span>}</code></pre>
<div class="figure" style="text-align: center"><span id="fig:tikz-venn"></span>
<img src="13-data-visualization-with-plot_files/figure-html/tikz-venn-1.png" alt="Venn 图" width="70%" />
<p class="caption">
图 12.61: Venn 图
</p>
</div>
</div>
<div id="export-save" class="section level2">
<h2><span class="header-section-number">12.4</span> 图形导出</h2>
<p>图形导出的格式主要看面向的呈现方式，如插入 HTML 网页中，可选 png， svg， rgl 和 gif 格式，插入 LaTeX 文档中，可选 eps，ps，pdf 和 png 等格式</p>
<p>保存绘制的图形，R 使用的图形渲染库的版本</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grSoftVersion</span>()
<span class="co">#&gt;                    cairo                   libpng                     jpeg </span>
<span class="co">#&gt;                 &quot;1.16.0&quot;                 &quot;1.6.34&quot;                    &quot;8.0&quot; </span>
<span class="co">#&gt;                  libtiff </span>
<span class="co">#&gt; &quot;LIBTIFF, Version 4.0.9&quot;</span></code></pre>
<p>当前 R 环境中支持的图形设备</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">capabilities</span>()
<span class="co">#&gt;        jpeg         png        tiff       tcltk         X11        aqua </span>
<span class="co">#&gt;        TRUE        TRUE        TRUE        TRUE       FALSE       FALSE </span>
<span class="co">#&gt;    http/ftp     sockets      libxml        fifo      cledit       iconv </span>
<span class="co">#&gt;        TRUE        TRUE        TRUE        TRUE       FALSE        TRUE </span>
<span class="co">#&gt;         NLS     profmem       cairo         ICU long.double     libcurl </span>
<span class="co">#&gt;        TRUE        TRUE        TRUE        TRUE        TRUE        TRUE</span></code></pre>
<table>
<caption><span id="tab:graphics-devices">表 12.3: </span> 图形设备列表</caption>
<thead>
<tr class="header">
<th align="left">设备</th>
<th align="left">函数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">windows</td>
<td align="left">cairo_pdf, cairo_ps</td>
</tr>
<tr class="even">
<td align="left">pdf</td>
<td align="left">svg</td>
</tr>
<tr class="odd">
<td align="left">postscript</td>
<td align="left">png</td>
</tr>
<tr class="even">
<td align="left">xfig</td>
<td align="left">jpeg</td>
</tr>
<tr class="odd">
<td align="left">bitmap</td>
<td align="left">bmp</td>
</tr>
<tr class="even">
<td align="left">pictex</td>
<td align="left">tiff</td>
</tr>
</tbody>
</table>
<p>图形设备控制函数</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apropos</span>(<span class="st">&quot;dev.&quot;</span>)
<span class="co">#&gt;  [1] &quot;.Device&quot;             &quot;.Devices&quot;            &quot;dev.capabilities&quot;   </span>
<span class="co">#&gt;  [4] &quot;dev.capture&quot;         &quot;dev.control&quot;         &quot;dev.copy&quot;           </span>
<span class="co">#&gt;  [7] &quot;dev.copy2eps&quot;        &quot;dev.copy2pdf&quot;        &quot;dev.cur&quot;            </span>
<span class="co">#&gt; [10] &quot;dev.flush&quot;           &quot;dev.hold&quot;            &quot;dev.interactive&quot;    </span>
<span class="co">#&gt; [13] &quot;dev.list&quot;            &quot;dev.new&quot;             &quot;dev.next&quot;           </span>
<span class="co">#&gt; [16] &quot;dev.off&quot;             &quot;dev.prev&quot;            &quot;dev.print&quot;          </span>
<span class="co">#&gt; [19] &quot;dev.set&quot;             &quot;dev.size&quot;            &quot;dev2bitmap&quot;         </span>
<span class="co">#&gt; [22] &quot;deval&quot;               &quot;devAskNewPage&quot;       &quot;deviance&quot;           </span>
<span class="co">#&gt; [25] &quot;deviceIsInteractive&quot;</span></code></pre>
<p>导入导出 SVG 格式矢量图形</p>
<p><a href="https://www.stat.auckland.ac.nz/~paul/Reports/grImport/butterfly/butterfly.html">The Butterfly Affectation: A case study in embedding an external image in an R plot</a></p>
<p><a href="https://sjp.co.nz/projects/grimport2/grImport2.html">Improved Importing of Vector Graphics in R</a></p>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-R-FAQ">
<p>Hornik, Kurt. 2018. “R FAQ.” <a href="https://CRAN.R-project.org/doc/FAQ/R-FAQ.html">https://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a>.</p>
</div>
<div id="ref-Paul_2003_Integrating">
<p>Murrell, Paul. 2003. “Integrating Grid Graphics Output with Base Graphics Output.” <em>R News</em> 3 (2): 7–12.</p>
</div>
<div id="ref-Paul_2000_Approach">
<p>Murrell, Paul, and Ross Ihaka. 2000. “An Approach to Providing Mathematical Annotation in Plots.” <em>Journal of Computational and Graphical Statistics</em> 9 (3): 582–99.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="12-data-cleaning-with-regexp.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="14-data-visualization-with-plot3d.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/RGraphics/edit/master/13-data-visualization-with-plot.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["RGraphics.pdf", "RGraphics.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
